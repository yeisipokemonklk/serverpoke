{
  "version": 3,
  "sources": ["../../../../server/chat-plugins/wifi.tsx"],
  "sourcesContent": ["/**\r\n * Wi-Fi chat-plugin. Only works in a room with id 'wifi'\r\n * Handles giveaways in the formats: question, lottery, gts\r\n * Written by Kris and bumbadadabum, based on the original plugin as written by Codelegend, SilverTactic, DanielCranham\r\n */\r\n\r\nimport {FS, Utils} from '../../lib';\r\n\r\nPunishments.addRoomPunishmentType({\r\n\ttype: 'GIVEAWAYBAN',\r\n\tdesc: 'banned from giveaways',\r\n});\r\n\r\nconst BAN_DURATION = 7 * 24 * 60 * 60 * 1000;\r\nconst RECENT_THRESHOLD = 30 * 24 * 60 * 60 * 1000;\r\n\r\nconst DATA_FILE = 'config/chat-plugins/wifi.json';\r\n\r\ntype Game = 'SwSh' | 'BDSP' | 'SV';\r\n\r\ninterface GiveawayData {\r\n\ttargetUserID: string;\r\n\tot: string;\r\n\ttid: string;\r\n\tgame: Game;\r\n\tprize: PokemonSet;\r\n\tivs: string[];\r\n\tball: string;\r\n\textraInfo: string;\r\n\t/** Staff handling it. */\r\n\tclaimed?: ID;\r\n}\r\n\r\ninterface QuestionGiveawayData extends GiveawayData {\r\n\tquestion: string;\r\n\tanswers: string[];\r\n}\r\n\r\ninterface LotteryGiveawayData extends GiveawayData {\r\n\twinners: number;\r\n}\r\n\r\ninterface WifiData {\r\n\twhitelist: string[];\r\n\tstats: {[k: string]: number[]};\r\n\tstoredGiveaways: {question: QuestionGiveawayData[], lottery: LotteryGiveawayData[]};\r\n\tsubmittedGiveaways: {question: QuestionGiveawayData[], lottery: LotteryGiveawayData[]};\r\n}\r\n\r\nconst defaults: WifiData = {\r\n\twhitelist: [],\r\n\tstats: {},\r\n\tstoredGiveaways: {\r\n\t\tquestion: [],\r\n\t\tlottery: [],\r\n\t},\r\n\tsubmittedGiveaways: {\r\n\t\tquestion: [],\r\n\t\tlottery: [],\r\n\t},\r\n};\r\n\r\nexport let wifiData: WifiData = (() => {\r\n\ttry {\r\n\t\treturn JSON.parse(FS(DATA_FILE).readSync());\r\n\t} catch (e: any) {\r\n\t\tif (e.code !== 'ENOENT') throw e;\r\n\t\treturn defaults;\r\n\t}\r\n})();\r\n\r\nfunction saveData() {\r\n\tFS(DATA_FILE).writeUpdate(() => JSON.stringify(wifiData));\r\n}\r\n\r\n// Convert old file type\r\nif (!wifiData.stats && !wifiData.storedGiveaways && !wifiData.submittedGiveaways) {\r\n\t// we cast under the assumption that it's the old file format\r\n\tconst stats = {...wifiData} as unknown as {[k: string]: number[]};\r\n\twifiData = {...defaults, stats};\r\n\tsaveData();\r\n}\r\n// ensure the whitelist exists for those who might have the conversion above but not the stats\r\nif (!wifiData.whitelist) wifiData.whitelist = [];\r\n\r\nconst statNames = [\"HP\", \"Atk\", \"Def\", \"SpA\", \"SpD\", \"Spe\"];\r\n\r\nconst gameName: {[k in Game]: string} = {\r\n\tSwSh: 'Sword/Shield',\r\n\tBDSP: 'Brilliant Diamond/Shining Pearl',\r\n\tSV: 'Scarlet/Violet',\r\n};\r\nconst gameidToGame: {[k: string]: Game} = {\r\n\tswsh: 'SwSh',\r\n\tbdsp: 'BDSP',\r\n\tsv: 'SV',\r\n};\r\n\r\nabstract class Giveaway extends Rooms.SimpleRoomGame {\r\n\toverride readonly gameid = 'giveaway' as ID;\r\n\tabstract type: string;\r\n\tgaNumber: number;\r\n\thost: User;\r\n\tgiver: User;\r\n\troom: Room;\r\n\tot: string;\r\n\ttid: string;\r\n\tgame: Game;\r\n\tivs: string[];\r\n\tprize: PokemonSet;\r\n\tphase: string;\r\n\tball: string;\r\n\textraInfo: string;\r\n\t/**\r\n\t * IP:userid\r\n\t */\r\n\tjoined: Map<string, ID>;\r\n\ttimer: NodeJS.Timer | null;\r\n\tpokemonID: ID;\r\n\tsprite: Chat.VNode;\r\n\r\n\tconstructor(\r\n\t\thost: User, giver: User, room: Room, ot: string, tid: string, ivs: string[],\r\n\t\tprize: PokemonSet, game: Game = 'SV', ball: string, extraInfo: string\r\n\t) {\r\n\t\t// Make into a sub-game if the gts ever opens up again\r\n\t\tsuper(room);\r\n\t\tthis.gaNumber = room.nextGameNumber();\r\n\t\tthis.host = host;\r\n\t\tthis.giver = giver;\r\n\t\tthis.room = room;\r\n\t\tthis.ot = ot;\r\n\t\tthis.tid = tid;\r\n\t\tthis.ball = ball;\r\n\t\tthis.extraInfo = extraInfo;\r\n\t\tthis.game = game;\r\n\t\tthis.ivs = ivs;\r\n\t\tthis.prize = prize;\r\n\t\tthis.phase = 'pending';\r\n\r\n\t\tthis.joined = new Map();\r\n\r\n\t\tthis.timer = null;\r\n\r\n\t\t[this.pokemonID, this.sprite] = Giveaway.getSprite(prize);\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.clearTimer();\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tgenerateReminder(joined?: boolean): string | Chat.VNode;\r\n\tgenerateReminder() {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tgetStyle() {\r\n\t\tconst css: {[k: string]: string | {[k: string]: string}} = {class: \"broadcast-blue\"};\r\n\t\tif (this.game === 'BDSP') css.style = {background: '#aa66a9', color: '#fff'};\r\n\t\tif (this.game === 'SV') css.style = {background: '#CD5C5C', color: '#fff'};\r\n\t\treturn css;\r\n\t}\r\n\r\n\tsendToUser(user: User, content: string | Chat.VNode) {\r\n\t\tuser.sendTo(\r\n\t\t\tthis.room,\r\n\t\t\tChat.html`|uhtmlchange|giveaway${this.gaNumber}${this.phase}|${<div {...this.getStyle()}>{content}</div>}`\r\n\t\t);\r\n\t}\r\n\r\n\tsend(content: string | Chat.VNode, isStart = false) {\r\n\t\tthis.room.add(Chat.html`|uhtml|giveaway${this.gaNumber}${this.phase}|${<div {...this.getStyle()}>{content}</div>}`);\r\n\t\tif (isStart) this.room.add(`|c:|${Math.floor(Date.now() / 1000)}|&|It's ${this.game} giveaway time!`);\r\n\t\tthis.room.update();\r\n\t}\r\n\r\n\tchangeUhtml(content: string | Chat.VNode) {\r\n\t\tthis.room.uhtmlchange(`giveaway${this.gaNumber}${this.phase}`, Chat.html`${<div {...this.getStyle()}>{content}</div>}`);\r\n\t\tthis.room.update();\r\n\t}\r\n\r\n\tclearTimer() {\r\n\t\tif (this.timer) {\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = null;\r\n\t\t}\r\n\t}\r\n\r\n\tcheckJoined(user: User) {\r\n\t\tfor (const [ip, id] of this.joined) {\r\n\t\t\tif (user.latestIp === ip && !Config.noipchecks) return ip;\r\n\t\t\tif (user.previousIDs.includes(id)) return id;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tkickUser(user: User) {\r\n\t\tfor (const [ip, id] of this.joined) {\r\n\t\t\tif (user.latestIp === ip && !Config.noipchecks || user.previousIDs.includes(id)) {\r\n\t\t\t\tthis.sendToUser(user, this.generateReminder());\r\n\t\t\t\tthis.joined.delete(ip);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcheckExcluded(user: User) {\r\n\t\treturn (\r\n\t\t\tuser === this.giver ||\r\n\t\t\t!Config.noipchecks && this.giver.ips.includes(user.latestIp) ||\r\n\t\t\tthis.giver.previousIDs.includes(toID(user))\r\n\t\t);\r\n\t}\r\n\r\n\tstatic checkCanCreate(context: Chat.CommandContext, targetUser: User, type: string) {\r\n\t\tconst user = context.user;\r\n\t\tconst isCreate = type === 'create';\r\n\t\tconst isForSelf = targetUser.id === user.id;\r\n\t\tif (wifiData.whitelist.includes(user.id) && isCreate && isForSelf) {\r\n\t\t\t// it being true doesn't matter here, it's just clearer that the user _is_ allowed\r\n\t\t\t// and it ensures execution stops here so the creation can proceed\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (isCreate && !(isForSelf && user.can('show', null, context.room!))) {\r\n\t\t\tcontext.checkCan('warn', null, context.room!);\r\n\t\t}\r\n\t\tif (!user.can('warn', null, context.room!) && !isCreate && !isForSelf) {\r\n\t\t\tthrow new Chat.ErrorMessage(`You can't ${type} giveways for other users.`);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic checkBanned(room: Room, user: User) {\r\n\t\treturn Punishments.hasRoomPunishType(room, toID(user), 'GIVEAWAYBAN');\r\n\t}\r\n\r\n\tstatic ban(room: Room, user: User, reason: string) {\r\n\t\tPunishments.roomPunish(room, user, {\r\n\t\t\ttype: 'GIVEAWAYBAN',\r\n\t\t\tid: toID(user),\r\n\t\t\texpireTime: Date.now() + BAN_DURATION,\r\n\t\t\treason,\r\n\t\t});\r\n\t}\r\n\r\n\tstatic unban(room: Room, user: User) {\r\n\t\tPunishments.roomUnpunish(room, user.id, 'GIVEAWAYBAN', false);\r\n\t}\r\n\r\n\tstatic getSprite(set: PokemonSet): [ID, Chat.VNode] {\r\n\t\tconst species = Dex.species.get(set.species);\r\n\t\tlet spriteid = species.spriteid;\r\n\t\tif (species.cosmeticFormes) {\r\n\t\t\tfor (const forme of species.cosmeticFormes.map(toID)) {\r\n\t\t\t\tif (toID(set.species).includes(forme)) {\r\n\t\t\t\t\tspriteid += '-' + forme.slice(species.baseSpecies.length);\r\n\t\t\t\t\tbreak; // We don't want to end up with deerling-summer-spring\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!spriteid.includes('-') && species.forme) { // for stuff like unown letters\r\n\t\t\tspriteid += '-' + toID(species.forme);\r\n\t\t}\r\n\t\tconst shiny = set.shiny ? '-shiny' : '';\r\n\r\n\t\tconst validFemale = [\r\n\t\t\t'abomasnow', 'aipom', 'ambipom', 'beautifly', 'bibarel', 'bidoof', 'blaziken', 'buizel', 'cacturne', 'camerupt', 'combee',\r\n\t\t\t'combusken', 'croagunk', 'donphan', 'dustox', 'finneon', 'floatzel', 'frillish', 'gabite', 'garchomp', 'gible', 'girafarig',\r\n\t\t\t'gligar', 'golbat', 'gulpin', 'heracross', 'hippopotas', 'hippowdon', 'houndoom', 'indeedee', 'jellicent', 'kerfluffle', 'kitsunoh',\r\n\t\t\t'kricketot', 'kricketune', 'ledian', 'ledyba', 'ludicolo', 'lumineon', 'luxio', 'luxray', 'magikarp', 'mamoswine', 'medicham',\r\n\t\t\t'meditite', 'meganium', 'meowstic', 'milotic', 'murkrow', 'nidoran', 'numel', 'nuzleaf', 'octillery', 'pachirisu', 'pikachu',\r\n\t\t\t'pikachu-starter', 'piloswine', 'politoed', 'protowatt', 'pyroar', 'quagsire', 'raticate', 'rattata', 'relicanth', 'rhydon',\r\n\t\t\t'rhyperior', 'roselia', 'roserade', 'rotom', 'scizor', 'scyther', 'shiftry', 'shinx', 'sneasel', 'snover', 'staraptor', 'staravia',\r\n\t\t\t'starly', 'steelix', 'sudowoodo', 'swalot', 'tangrowth', 'torchic', 'toxicroak', 'unfezant', 'unown', 'ursaring', 'voodoom',\r\n\t\t\t'weavile', 'wobbuffet', 'wooper', 'xatu', 'zubat',\r\n\t\t];\r\n\t\tif (set.gender === 'F' && validFemale.includes(species.id)) spriteid += '-f';\r\n\t\treturn [\r\n\t\t\tspecies.id,\r\n\t\t\t<img src={`/sprites/ani${shiny}/${spriteid}.gif`} />,\r\n\t\t];\r\n\t}\r\n\r\n\tstatic updateStats(pokemonIDs: Set<string>) {\r\n\t\tfor (const mon of pokemonIDs) {\r\n\t\t\tif (!wifiData.stats[mon]) wifiData.stats[mon] = [];\r\n\t\t\twifiData.stats[mon].push(Date.now());\r\n\t\t}\r\n\t\tsaveData();\r\n\t}\r\n\r\n\t// Wi-Fi uses special IV syntax to show hyper trained IVs\r\n\tstatic convertIVs(setObj: PokemonSet, ivs: string[]) {\r\n\t\tlet set = Teams.exportSet(setObj);\r\n\t\tlet ivsStr = '';\r\n\t\tif (ivs.length) {\r\n\t\t\tconst convertedIVs = {hp: '31', atk: '31', def: '31', spa: '31', spd: '31', spe: '31'};\r\n\t\t\tfor (const [i, iv] of ivs.entries()) {\r\n\t\t\t\tconst numStr = iv.trim().split(' ')[0];\r\n\t\t\t\tconst statName = statNames[i];\r\n\t\t\t\tconvertedIVs[toID(statName) as StatID] = numStr;\r\n\t\t\t}\r\n\t\t\tconst array = Object.keys(convertedIVs).map((x, i) => `${convertedIVs[x as StatID]} ${statNames[i]}`);\r\n\t\t\tivsStr = `IVs: ${array.join(' / ')}  `;\r\n\t\t}\r\n\t\tif (ivsStr) {\r\n\t\t\tif (/\\nivs:/i.test(set)) {\r\n\t\t\t\tconst arr = set.split('\\n');\r\n\t\t\t\tconst index = arr.findIndex(x => /^ivs:/i.test(x));\r\n\t\t\t\tarr[index] = ivsStr;\r\n\t\t\t\tset = arr.join('\\n');\r\n\t\t\t} else if (/nature\\n/i.test(set)) {\r\n\t\t\t\tconst arr = set.split('\\n');\r\n\t\t\t\tconst index = arr.findIndex(x => /nature$/i.test(x));\r\n\t\t\t\tarr.splice(index + 1, 0, ivsStr);\r\n\t\t\t\tset = arr.join('\\n');\r\n\t\t\t} else {\r\n\t\t\t\tset += `\\n${ivsStr}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn set;\r\n\t}\r\n\r\n\tgenerateWindow(rightSide: Chat.VNode | string): Chat.VNode {\r\n\t\tconst set = Giveaway.convertIVs(this.prize, this.ivs);\r\n\t\treturn <center>\r\n\t\t\t<h3>It's {this.game} giveaway time!</h3>\r\n\t\t\t<small>Giveaway started by {this.host.name}</small>\r\n\t\t\t<table style={{marginLeft: 'auto', marginRight: 'auto'}}>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td colSpan={2} style={{textAlign: 'center'}}>\r\n\t\t\t\t\t\t<strong>Giver:</strong> {this.giver.name}<br />\r\n\t\t\t\t\t\t<strong>OT:</strong> {this.ot}, <strong>TID:</strong> {this.tid}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td style={{textAlign: 'center', width: '45%'}}>\r\n\t\t\t\t\t\t<psicon item={this.ball} /> {this.sprite} <psicon item={this.ball} /><br />\r\n\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{set}</Chat.JSX.FormatText>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td style={{textAlign: 'center', width: '45%'}}>{rightSide}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t{!!this.extraInfo?.trim().length && <tr>\r\n\t\t\t\t\t<td colSpan={2} style={{textAlign: 'center'}}>\r\n\t\t\t\t\t\t<strong>Extra Information</strong><br />\r\n\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{this.extraInfo.trim().replace(/<br \\/>/g, '\\n')}</Chat.JSX.FormatText>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>}\r\n\t\t\t</table>\r\n\t\t\t<p style={{textAlign: 'center', fontSize: '7pt', fontWeight: 'bold'}}>\r\n\t\t\t\t<u>Note:</u> You must have a Switch, Pok&eacute;mon {gameName[this.game]}, {}\r\n\t\t\t\tand NSO to receive the prize. {}\r\n\t\t\t\tDo not join if you are currently unable to trade. Do not enter if you have already won this exact Pok&eacute;mon, {}\r\n\t\t\t\tunless it is explicitly allowed.\r\n\t\t\t</p>\r\n\t\t</center>;\r\n\t}\r\n}\r\n\r\nexport class QuestionGiveaway extends Giveaway {\r\n\ttype: string;\r\n\tquestion: string;\r\n\tanswers: string[];\r\n\t/** userid: number of guesses */\r\n\tanswered: Utils.Multiset<string>;\r\n\twinner: User | null;\r\n\r\n\tconstructor(\r\n\t\thost: User, giver: User, room: Room, ot: string, tid: string, game: Game, ivs: string[],\r\n\t\tprize: PokemonSet, question: string, answers: string[], ball: string, extraInfo: string\r\n\t) {\r\n\t\tsuper(host, giver, room, ot, tid, ivs, prize, game, ball, extraInfo);\r\n\t\tthis.type = 'question';\r\n\t\tthis.phase = 'pending';\r\n\r\n\t\tthis.question = question;\r\n\t\tthis.answers = QuestionGiveaway.sanitizeAnswers(answers);\r\n\t\tthis.answered = new Utils.Multiset();\r\n\t\tthis.winner = null;\r\n\t\tthis.send(this.generateWindow('The question will be displayed in one minute! Use /guess to answer.'), true);\r\n\r\n\t\tthis.timer = setTimeout(() => this.start(), 1000 * 60);\r\n\t}\r\n\r\n\tstatic splitTarget(\r\n\t\ttarget: string, sep = '|', context: Chat.CommandContext,\r\n\t\tuser: User, type: 'create' | 'store' | 'submit'\r\n\t) {\r\n\t\tlet [\r\n\t\t\tgiver, ot, tid, game, question, answers, ivs, ball, extraInfo, ...prize\r\n\t\t] = target.split(sep).map(param => param.trim());\r\n\t\tif (!(giver && ot && tid && prize?.length && question && answers?.split(',').length)) {\r\n\t\t\tcontext.parse(`/help giveaway`);\r\n\t\t\tthrow new Chat.Interruption();\r\n\t\t}\r\n\t\tconst targetUser = Users.get(giver);\r\n\t\tif (!targetUser?.connected) throw new Chat.ErrorMessage(`User '${giver}' is not online.`);\r\n\r\n\t\tGiveaway.checkCanCreate(context, targetUser, type);\r\n\r\n\t\tif (!!ivs && ivs.split('/').length !== 6) {\r\n\t\t\tthrow new Chat.ErrorMessage(`If you provide IVs, they must be provided for all stats.`);\r\n\t\t}\r\n\t\tif (!game) game = 'SV';\r\n\t\tgame = gameidToGame[toID(game)] || game as Game;\r\n\t\tif (!game || !['SV', 'BDSP', 'SwSh'].includes(game)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`The game must be \"SV,\" \"BDSP,\" or \"SwSh\".`);\r\n\t\t}\r\n\t\tif (!ball) ball = 'pokeball';\r\n\t\tif (!toID(ball).endsWith('ball')) ball = toID(ball) + 'ball';\r\n\t\tif (!Dex.items.get(ball).isPokeball) {\r\n\t\t\tthrow new Chat.ErrorMessage(`${Dex.items.get(ball).name} is not a Pok\\u00e9 Ball.`);\r\n\t\t}\r\n\t\ttid = toID(tid);\r\n\t\tif (isNaN(parseInt(tid)) || tid.length < 5 || tid.length > 6) throw new Chat.ErrorMessage(\"Invalid TID\");\r\n\t\tif (!targetUser.autoconfirmed) {\r\n\t\t\tthrow new Chat.ErrorMessage(`User '${targetUser.name}' needs to be autoconfirmed to give something away.`);\r\n\t\t}\r\n\t\tif (Giveaway.checkBanned(context.room!, targetUser)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`User '${targetUser.name}' is giveaway banned.`);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttargetUser, ot, tid, game: game as Game, question, answers: answers.split(','),\r\n\t\t\tivs: ivs.split('/'), ball, extraInfo, prize: prize.join('|'),\r\n\t\t};\r\n\t}\r\n\r\n\tgenerateQuestion() {\r\n\t\treturn this.generateWindow(<>\r\n\t\t\t<p style={{textAlign: 'center', fontSize: '13pt'}}>Giveaway Question: <b>{this.question}</b></p>\r\n\t\t\t<p style={{textAlign: 'center'}}>use /guess to answer.</p>\r\n\t\t</>);\r\n\t}\r\n\r\n\tstart() {\r\n\t\tthis.changeUhtml(<p style={{textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'}}>\r\n\t\t\tThe giveaway has started! Scroll down to see the question.\r\n\t\t</p>);\r\n\t\tthis.phase = 'started';\r\n\t\tthis.send(this.generateQuestion());\r\n\t\tthis.timer = setTimeout(() => this.end(false), 1000 * 60 * 5);\r\n\t}\r\n\r\n\tchoose(user: User, guess: string) {\r\n\t\tif (this.phase !== 'started') return user.sendTo(this.room, \"The giveaway has not started yet.\");\r\n\r\n\t\tif (this.checkJoined(user) && ![...this.joined.values()].includes(user.id)) {\r\n\t\t\treturn user.sendTo(this.room, \"You have already joined the giveaway.\");\r\n\t\t}\r\n\t\tif (Giveaway.checkBanned(this.room, user)) return user.sendTo(this.room, \"You are banned from entering giveaways.\");\r\n\t\tif (this.checkExcluded(user)) return user.sendTo(this.room, \"You are disallowed from entering the giveaway.\");\r\n\r\n\t\tif ((this.answered.get(user.id) ?? 0) >= 3) {\r\n\t\t\treturn user.sendTo(\r\n\t\t\t\tthis.room,\r\n\t\t\t\t\"You have already guessed three times. You cannot guess anymore in this.giveaway.\"\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst sanitized = toID(guess);\r\n\r\n\t\tfor (const answer of this.answers.map(toID)) {\r\n\t\t\tif (answer === sanitized) {\r\n\t\t\t\tthis.winner = user;\r\n\t\t\t\tthis.clearTimer();\r\n\t\t\t\treturn this.end(false);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.joined.set(user.latestIp, user.id);\r\n\t\tthis.answered.add(user.id);\r\n\t\tif ((this.answered.get(user.id) ?? 0) >= 3) {\r\n\t\t\tuser.sendTo(\r\n\t\t\t\tthis.room,\r\n\t\t\t\t`Your guess '${guess}' is wrong. You have used up all of your guesses. Better luck next time!`\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tuser.sendTo(this.room, `Your guess '${guess}' is wrong. Try again!`);\r\n\t\t}\r\n\t}\r\n\r\n\tchange(value: string, user: User, answer = false) {\r\n\t\tif (user.id !== this.host.id) return user.sendTo(this.room, \"Only the host can edit the giveaway.\");\r\n\t\tif (this.phase !== 'pending') {\r\n\t\t\treturn user.sendTo(this.room, \"You cannot change the question or answer once the giveaway has started.\");\r\n\t\t}\r\n\t\tif (!answer) {\r\n\t\t\tthis.question = value;\r\n\t\t\treturn user.sendTo(this.room, `The question has been changed to ${value}.`);\r\n\t\t}\r\n\t\tconst ans = QuestionGiveaway.sanitizeAnswers(value.split(',').map(val => val.trim()));\r\n\t\tif (!ans.length) {\r\n\t\t\treturn user.sendTo(this.room, \"You must specify at least one answer and it must not contain any special characters.\");\r\n\t\t}\r\n\t\tthis.answers = ans;\r\n\t\tuser.sendTo(this.room, `The answer${Chat.plural(ans, \"s have\", \"has\")} been changed to ${ans.join(', ')}.`);\r\n\t}\r\n\r\n\tend(force: boolean) {\r\n\t\tconst style = {textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'};\r\n\t\tif (force) {\r\n\t\t\tthis.clearTimer();\r\n\t\t\tthis.changeUhtml(<p style={style}>The giveaway was forcibly ended.</p>);\r\n\t\t\tthis.room.send(\"The giveaway was forcibly ended.\");\r\n\t\t} else {\r\n\t\t\tif (!this.winner) {\r\n\t\t\t\tthis.changeUhtml(<p style={style}>The giveaway was forcibly ended.</p>);\r\n\t\t\t\tthis.room.send(\"The giveaway has been forcibly ended as no one has answered the question.\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.changeUhtml(<p style={style}>The giveaway has ended! Scroll down to see the answer.</p>);\r\n\t\t\t\tthis.phase = 'ended';\r\n\t\t\t\tthis.clearTimer();\r\n\t\t\t\tthis.room.modlog({\r\n\t\t\t\t\taction: 'GIVEAWAY WIN',\r\n\t\t\t\t\tuserid: this.winner.id,\r\n\t\t\t\t\tnote: `${this.giver.name}'s giveaway for a \"${this.prize.species}\" (OT: ${this.ot} TID: ${this.tid} Nature: ${this.prize.nature} Ball: ${this.ball}${this.extraInfo ? ` Other box info: ${this.extraInfo}` : ''})`,\r\n\t\t\t\t});\r\n\t\t\t\tthis.send(this.generateWindow(<>\r\n\t\t\t\t\t<p style={{textAlign: 'center', fontSize: '12pt'}}>\r\n\t\t\t\t\t\t<b>{this.winner.name}</b> won the giveaway! Congratulations!\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p style={{textAlign: 'center'}}>\r\n\t\t\t\t\t\t{this.question}<br />\r\n\t\t\t\t\t\tCorrect answer{Chat.plural(this.answers)}: {this.answers.join(', ')}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</>));\r\n\t\t\t\tthis.winner.sendTo(\r\n\t\t\t\t\tthis.room,\r\n\t\t\t\t\t`|raw|You have won the giveaway. PM <b>${Utils.escapeHTML(this.giver.name)}</b> to claim your prize!`\r\n\t\t\t\t);\r\n\t\t\t\tif (this.winner.connected) {\r\n\t\t\t\t\tthis.winner.popup(`You have won the giveaway. PM **${this.giver.name}** to claim your prize!`);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.giver.connected) this.giver.popup(`${this.winner.name} has won your question giveaway!`);\r\n\t\t\t\tGiveaway.updateStats(new Set([this.pokemonID]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.destroy();\r\n\t}\r\n\r\n\tstatic sanitize(str: string) {\r\n\t\treturn str.toLowerCase().replace(/[^a-z0-9 .-]+/ig, \"\").trim();\r\n\t}\r\n\r\n\tstatic sanitizeAnswers(answers: string[]) {\r\n\t\treturn answers.map(\r\n\t\t\tval => QuestionGiveaway.sanitize(val)\r\n\t\t).filter(\r\n\t\t\t(val, index, array) => toID(val).length && array.indexOf(val) === index\r\n\t\t);\r\n\t}\r\n\r\n\tcheckExcluded(user: User) {\r\n\t\tif (user === this.host) return true;\r\n\t\tif (this.host.ips.includes(user.latestIp) && !Config.noipchecks) return true;\r\n\t\tif (this.host.previousIDs.includes(toID(user))) return true;\r\n\t\treturn super.checkExcluded(user);\r\n\t}\r\n}\r\n\r\nexport class LotteryGiveaway extends Giveaway {\r\n\ttype: string;\r\n\twinners: User[];\r\n\tmaxWinners: number;\r\n\r\n\tconstructor(\r\n\t\thost: User, giver: User, room: Room, ot: string, tid: string, ivs: string[],\r\n\t\tgame: Game, prize: PokemonSet, winners: number, ball: string, extraInfo: string\r\n\t) {\r\n\t\tsuper(host, giver, room, ot, tid, ivs, prize, game, ball, extraInfo);\r\n\r\n\t\tthis.type = 'lottery';\r\n\t\tthis.phase = 'pending';\r\n\r\n\t\tthis.winners = [];\r\n\r\n\t\tthis.maxWinners = winners || 1;\r\n\r\n\t\tthis.send(this.generateReminder(false), true);\r\n\r\n\t\tthis.timer = setTimeout(() => this.drawLottery(), 1000 * 60 * 2);\r\n\t}\r\n\r\n\tstatic splitTarget(\r\n\t\ttarget: string, sep = '|', context: Chat.CommandContext,\r\n\t\tuser: User, type: 'create' | 'store' | 'submit'\r\n\t) {\r\n\t\tlet [giver, ot, tid, game, winners, ivs, ball, extraInfo, ...prize] = target.split(sep).map(param => param.trim());\r\n\t\tif (!(giver && ot && tid && prize?.length)) {\r\n\t\t\tcontext.parse(`/help giveaway`);\r\n\t\t\tthrow new Chat.Interruption();\r\n\t\t}\r\n\t\tconst targetUser = Users.get(giver);\r\n\t\tif (!targetUser?.connected) throw new Chat.ErrorMessage(`User '${giver}' is not online.`);\r\n\r\n\t\tGiveaway.checkCanCreate(context, user, type);\r\n\r\n\t\tif (!!ivs && ivs.split('/').length !== 6) {\r\n\t\t\tthrow new Chat.ErrorMessage(`If you provide IVs, they must be provided for all stats.`);\r\n\t\t}\r\n\t\tif (!game) game = 'SV';\r\n\t\tgame = gameidToGame[toID(game)] || game as Game;\r\n\t\tif (!game || !['SV', 'BDSP', 'SwSh'].includes(game)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`The game must be \"SV,\" \"BDSP,\" or \"SwSh\".`);\r\n\t\t}\r\n\t\tif (!ball) ball = 'pokeball';\r\n\t\tif (!toID(ball).endsWith('ball')) ball = toID(ball) + 'ball';\r\n\t\tif (!Dex.items.get(ball).isPokeball) {\r\n\t\t\tthrow new Chat.ErrorMessage(`${Dex.items.get(ball).name} is not a Pok\\u00e9 Ball.`);\r\n\t\t}\r\n\t\ttid = toID(tid);\r\n\t\tif (isNaN(parseInt(tid)) || tid.length < 5 || tid.length > 6) throw new Chat.ErrorMessage(\"Invalid TID\");\r\n\t\tif (!targetUser.autoconfirmed) {\r\n\t\t\tthrow new Chat.ErrorMessage(`User '${targetUser.name}' needs to be autoconfirmed to give something away.`);\r\n\t\t}\r\n\t\tif (Giveaway.checkBanned(context.room!, targetUser)) {\r\n\t\t\tthrow new Chat.ErrorMessage(`User '${targetUser.name}' is giveaway banned.`);\r\n\t\t}\r\n\r\n\t\tlet numWinners = 1;\r\n\t\tif (winners) {\r\n\t\t\tnumWinners = parseInt(winners);\r\n\t\t\tif (isNaN(numWinners) || numWinners < 1 || numWinners > 5) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(\"The lottery giveaway can have a minimum of 1 and a maximum of 5 winners.\");\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttargetUser, ot, tid, game: game as Game, winners: numWinners,\r\n\t\t\tivs: ivs.split('/'), ball, extraInfo, prize: prize.join('|'),\r\n\t\t};\r\n\t}\r\n\r\n\tgenerateReminder(joined = false) {\r\n\t\tconst cmd = (joined ? 'Leave' : 'Join');\r\n\t\treturn this.generateWindow(<>\r\n\t\t\tThe lottery drawing will occur in 2 minutes, and with {Chat.count(this.maxWinners, \"winners\")}!<br />\r\n\t\t\t<button class=\"button\" name=\"send\" value={`/giveaway ${toID(cmd)}lottery`}><strong>{cmd}</strong></button>\r\n\t\t</>);\r\n\t}\r\n\r\n\tdisplay() {\r\n\t\tconst joined = this.generateReminder(true);\r\n\t\tconst notJoined = this.generateReminder();\r\n\r\n\t\tfor (const i in this.room.users) {\r\n\t\t\tconst thisUser = this.room.users[i];\r\n\t\t\tif (this.checkJoined(thisUser)) {\r\n\t\t\t\tthis.sendToUser(thisUser, joined);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendToUser(thisUser, notJoined);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddUser(user: User) {\r\n\t\tif (this.phase !== 'pending') return user.sendTo(this.room, \"The join phase of the lottery giveaway has ended.\");\r\n\r\n\t\tif (!user.named) return user.sendTo(this.room, \"You need to choose a name before joining a lottery giveaway.\");\r\n\t\tif (this.checkJoined(user)) return user.sendTo(this.room, \"You have already joined the giveaway.\");\r\n\t\tif (Giveaway.checkBanned(this.room, user)) return user.sendTo(this.room, \"You are banned from entering giveaways.\");\r\n\t\tif (this.checkExcluded(user)) return user.sendTo(this.room, \"You are disallowed from entering the giveaway.\");\r\n\r\n\t\tthis.joined.set(user.latestIp, user.id);\r\n\t\tthis.sendToUser(user, this.generateReminder(true));\r\n\t\tuser.sendTo(this.room, \"You have successfully joined the lottery giveaway.\");\r\n\t}\r\n\r\n\tremoveUser(user: User) {\r\n\t\tif (this.phase !== 'pending') return user.sendTo(this.room, \"The join phase of the lottery giveaway has ended.\");\r\n\t\tif (!this.checkJoined(user)) return user.sendTo(this.room, \"You have not joined the lottery giveaway.\");\r\n\t\tfor (const [ip, id] of this.joined) {\r\n\t\t\tif (ip === user.latestIp && !Config.noipchecks || id === user.id) {\r\n\t\t\t\tthis.joined.delete(ip);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.sendToUser(user, this.generateReminder(false));\r\n\t\tuser.sendTo(this.room, \"You have left the lottery giveaway.\");\r\n\t}\r\n\r\n\tdrawLottery() {\r\n\t\tthis.clearTimer();\r\n\r\n\t\tconst userlist = [...this.joined.values()];\r\n\t\tif (userlist.length === 0) {\r\n\t\t\tthis.changeUhtml(<p style={{textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'}}>\r\n\t\t\t\tThe giveaway was forcibly ended.\r\n\t\t\t</p>);\r\n\t\t\tthis.room.send(\"The giveaway has been forcibly ended as there are no participants.\");\r\n\t\t\treturn this.destroy();\r\n\t\t}\r\n\r\n\t\twhile (this.winners.length < this.maxWinners && userlist.length > 0) {\r\n\t\t\tconst winner = Users.get(userlist.splice(Math.floor(Math.random() * userlist.length), 1)[0]);\r\n\t\t\tif (!winner) continue;\r\n\t\t\tthis.winners.push(winner);\r\n\t\t}\r\n\t\tthis.end();\r\n\t}\r\n\r\n\tend(force = false) {\r\n\t\tconst style = {textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'};\r\n\t\tif (force) {\r\n\t\t\tthis.clearTimer();\r\n\t\t\tthis.changeUhtml(<p style={style}>The giveaway was forcibly ended.</p>);\r\n\t\t\tthis.room.send(\"The giveaway was forcibly ended.\");\r\n\t\t} else {\r\n\t\t\tthis.changeUhtml(<p style={style}>\r\n\t\t\t\tThe giveaway has ended! Scroll down to see the winner{Chat.plural(this.winners)}.\r\n\t\t\t</p>);\r\n\t\t\tthis.phase = 'ended';\r\n\t\t\tconst winnerNames = this.winners.map(winner => winner.name).join(', ');\r\n\t\t\tthis.room.modlog({\r\n\t\t\t\taction: 'GIVEAWAY WIN',\r\n\t\t\t\tnote: `${winnerNames} won ${this.giver.name}'s giveaway for \"${this.prize.species}\" (OT: ${this.ot} TID: ${this.tid} Nature: ${this.prize.nature} Ball: ${this.ball}${this.extraInfo ? ` Other box info: ${this.extraInfo}` : ''})`,\r\n\t\t\t});\r\n\t\t\tthis.send(this.generateWindow(<>\r\n\t\t\t\t<p style={{textAlign: 'center', fontSize: '10pt', fontWeight: 'bold'}}>Lottery Draw</p>\r\n\t\t\t\t<p style={{textAlign: 'center'}}>{Chat.count(this.joined.size, 'users')} joined the giveaway.<br />\r\n\t\t\t\tOur lucky winner{Chat.plural(this.winners)}: <b>{winnerNames}</b>!<br />Congratulations!</p>\r\n\t\t\t</>));\r\n\t\t\tfor (const winner of this.winners) {\r\n\t\t\t\twinner.sendTo(\r\n\t\t\t\t\tthis.room,\r\n\t\t\t\t\t`|raw|You have won the lottery giveaway! PM <b>${this.giver.name}</b> to claim your prize!`\r\n\t\t\t\t);\r\n\t\t\t\tif (winner.connected) {\r\n\t\t\t\t\twinner.popup(`You have won the lottery giveaway! PM **${this.giver.name}** to claim your prize!`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.giver.connected) this.giver.popup(`The following users have won your lottery giveaway:\\n${winnerNames}`);\r\n\t\t\tGiveaway.updateStats(new Set([this.pokemonID]));\r\n\t\t}\r\n\t\tthis.destroy();\r\n\t}\r\n}\r\n\r\nexport class GTS extends Rooms.SimpleRoomGame {\r\n\toverride readonly gameid = 'gts' as ID;\r\n\tgtsNumber: number;\r\n\troom: Room;\r\n\tgiver: User;\r\n\tleft: number;\r\n\tsummary: string;\r\n\tdeposit: string;\r\n\tlookfor: string;\r\n\tpokemonID: ID;\r\n\tsprite: Chat.VNode;\r\n\tsent: string[];\r\n\tnoDeposits: boolean;\r\n\ttimer: NodeJS.Timer | null;\r\n\r\n\tconstructor(\r\n\t\troom: Room, giver: User, amount: number,\r\n\t\tsummary: string, deposit: string, lookfor: string\r\n\t) {\r\n\t\t// Always a sub-game so tours etc can be ran while GTS games are running\r\n\t\tsuper(room, true);\r\n\t\tthis.gtsNumber = room.nextGameNumber();\r\n\t\tthis.room = room;\r\n\t\tthis.giver = giver;\r\n\t\tthis.left = amount;\r\n\t\tthis.summary = summary;\r\n\t\tthis.deposit = GTS.linkify(Utils.escapeHTML(deposit));\r\n\t\tthis.lookfor = lookfor;\r\n\r\n\t\t// Deprecated, just typed like this to prevent errors, will rewrite when GTS is planned to be used again\r\n\t\t[this.pokemonID, this.sprite] = Giveaway.getSprite({species: summary} as PokemonSet);\r\n\r\n\t\tthis.sent = [];\r\n\t\tthis.noDeposits = false;\r\n\r\n\t\tthis.timer = setInterval(() => this.send(this.generateWindow()), 1000 * 60 * 5);\r\n\t\tthis.send(this.generateWindow());\r\n\t}\r\n\r\n\tsend(content: string) {\r\n\t\tthis.room.add(Chat.html`|uhtml|gtsga${this.gtsNumber}|${<div class=\"broadcast-blue\">{content}</div>}`);\r\n\t\tthis.room.update();\r\n\t}\r\n\r\n\tchangeUhtml(content: string) {\r\n\t\tthis.room.uhtmlchange(`gtsga${this.gtsNumber}`, Chat.html`${<div class=\"broadcast-blue\">{content}</div>}`);\r\n\t\tthis.room.update();\r\n\t}\r\n\r\n\tclearTimer() {\r\n\t\tif (this.timer) {\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = null;\r\n\t\t}\r\n\t}\r\n\r\n\tgenerateWindow() {\r\n\t\tconst sentModifier = this.sent.length ? 5 : 0;\r\n\t\tconst rightSide = this.noDeposits ?\r\n\t\t\t<strong>\r\n\t\t\t\tMore Pok&eacute;mon have been deposited than there are prizes in this giveaway and new deposits will not be accepted. {}\r\n\t\t\t\tIf you have already deposited a Pok&eacute;mon, please be patient, and do not withdraw your Pok&eacute;mon.\r\n\t\t\t</strong> : <>\r\n\t\t\t\tTo participate, deposit <strong>{this.deposit}</strong> into the GTS and look for <strong>{this.lookfor}</strong>\r\n\t\t\t</>;\r\n\t\treturn <>\r\n\t\t\t<p style={{textAlign: 'center', fontSize: '14pt', fontWeight: 'bold', marginBottom: '2px'}}>\r\n\t\t\t\tThere is a GTS giveaway going on!\r\n\t\t\t</p>\r\n\t\t\t<p style={{textAlign: 'center', fontSize: '10pt', marginTop: 0}}>\r\n\t\t\t\tHosted by: {this.giver.name} | Left: <b>{this.left}</b>\r\n\t\t\t</p>\r\n\t\t\t<table style={{margin: 'inherit auto'}}>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t{!!sentModifier && <td style={{textAlign: 'center', width: '10%'}}>\r\n\t\t\t\t\t\t<b>Last winners:</b><br />\r\n\t\t\t\t\t\t{this.sent.join(<br />)}\r\n\t\t\t\t\t</td>}\r\n\t\t\t\t\t<td style={{textAlign: 'center', width: '15%'}}>{this.sprite}</td>\r\n\t\t\t\t\t<td style={{textAlign: 'center', width: `${40 - sentModifier}%`}}>\r\n\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{this.summary}</Chat.JSX.FormatText>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td style={{textAlign: 'center', width: `${35 - sentModifier}%`}}>{rightSide}</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</table>\r\n\t\t</>;\r\n\t}\r\n\r\n\tupdateLeft(num: number) {\r\n\t\tthis.left = num;\r\n\t\tif (this.left < 1) return this.end();\r\n\r\n\t\tthis.changeUhtml(this.generateWindow());\r\n\t}\r\n\r\n\tupdateSent(ign: string) {\r\n\t\tthis.left--;\r\n\t\tif (this.left < 1) return this.end();\r\n\r\n\t\tthis.sent.push(ign);\r\n\t\tif (this.sent.length > 5) this.sent.shift();\r\n\r\n\t\tthis.changeUhtml(this.generateWindow());\r\n\t}\r\n\r\n\tstopDeposits() {\r\n\t\tthis.noDeposits = true;\r\n\r\n\t\tthis.room.send(Chat.html`|html|${<p style={{textAlign: 'center', fontSize: '11pt'}}>\r\n\t\t\tMore Pok&eacute;mon have been deposited than there are prizes in this giveaway and new deposits will not be accepted. {}\r\n\t\t\tIf you have already deposited a Pok&eacute;mon, please be patient, and do not withdraw your Pok&eacute;mon.\r\n\t\t</p>}`);\r\n\t\tthis.changeUhtml(this.generateWindow());\r\n\t}\r\n\r\n\tend(force = false) {\r\n\t\tif (force) {\r\n\t\t\tthis.clearTimer();\r\n\t\t\tthis.changeUhtml(\r\n\t\t\t\t<p style={{textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'}}>The GTS giveaway was forcibly ended.</p>\r\n\t\t\t);\r\n\t\t\tthis.room.send(\"The GTS giveaway was forcibly ended.\");\r\n\t\t} else {\r\n\t\t\tthis.clearTimer();\r\n\t\t\tthis.changeUhtml(\r\n\t\t\t\t<p style={{textAlign: 'center', fontSize: '13pt', fontWeight: 'bold'}}>The GTS giveaway has finished.</p>\r\n\t\t\t);\r\n\t\t\tthis.room.modlog({\r\n\t\t\t\taction: 'GTS FINISHED',\r\n\t\t\t\tuserid: this.giver.id,\r\n\t\t\t\tnote: `their GTS giveaway for \"${this.summary}\"`,\r\n\t\t\t});\r\n\t\t\tthis.send(<p style={{textAlign: 'center', fontSize: '11pt'}}>\r\n\t\t\t\tThe GTS giveaway for a \"<strong>{this.lookfor}</strong>\" has finished.\r\n\t\t\t</p>);\r\n\t\t\tGiveaway.updateStats(new Set([this.pokemonID]));\r\n\t\t}\r\n\t\tthis.room.subGame = null;\r\n\t\treturn this.left;\r\n\t}\r\n\r\n\t// This currently doesn't match some of the edge cases the other pokemon matching function does account for\r\n\t// (such as Type: Null). However, this should never be used as a fodder mon anyway,\r\n\t// so I don't see a huge need to implement it.\r\n\tstatic linkify(text: string) {\r\n\t\tconst parsed = toID(text);\r\n\r\n\t\tfor (const species of Dex.species.all()) {\r\n\t\t\tconst id = species.id;\r\n\t\t\tconst regexp = new RegExp(`\\\\b${id}\\\\b`, 'ig');\r\n\t\t\tconst res = regexp.exec(parsed);\r\n\t\t\tif (res) {\r\n\t\t\t\tconst num = String(species.num).padStart(3, '0');\r\n\t\t\t\treturn <>\r\n\t\t\t\t\t{text.slice(0, res.index)}\r\n\t\t\t\t\t<a href={`http://www.serebii.net/pokedex-sm/location/${num}.shtml`}>\r\n\t\t\t\t\t\t{text.slice(res.index, res.index + res[0].length)}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t{text.slice(res.index + res[0].length)}\r\n\t\t\t\t</>;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n}\r\n\r\nfunction hasSubmittedGiveaway(user: User) {\r\n\tfor (const [key, giveaways] of Object.entries(wifiData.submittedGiveaways)) {\r\n\t\tfor (const [index, giveaway] of giveaways.entries()) {\r\n\t\t\tif (user.id === giveaway.targetUserID) {\r\n\t\t\t\treturn {index, type: key as 'question' | 'lottery'};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nexport const handlers: Chat.Handlers = {\r\n\tonDisconnect(user) {\r\n\t\tconst giveaway = hasSubmittedGiveaway(user);\r\n\t\tif (giveaway) {\r\n\t\t\twifiData.submittedGiveaways[giveaway.type].splice(giveaway.index, 1);\r\n\t\t\tsaveData();\r\n\t\t}\r\n\t},\r\n};\r\n\r\nexport const commands: Chat.ChatCommands = {\r\n\tgts: {\r\n\t\tnew: 'start',\r\n\t\tcreate: 'start',\r\n\t\tstart(target, room, user) {\r\n\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\tif (!room) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t}\r\n\t\t\tif (room.getGame(GTS, true)) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`There is already a GTS Giveaway going on.`);\r\n\t\t\t}\r\n\t\t\t// GTS is currently deprecated until it's no longer behind a paywall\r\n\t\t\treturn this.parse(`/help gts`);\r\n\t\t\t/*\r\n\t\t\tconst [giver, amountStr, summary, deposit, lookfor] = target.split(target.includes('|') ? '|' : ',').map(\r\n\t\t\t\tparam => param.trim()\r\n\t\t\t);\r\n\t\t\tif (!(giver && amountStr && summary && deposit && lookfor)) {\r\n\t\t\t\treturn this.errorReply(\"Invalid arguments specified - /gts start giver | amount | summary | deposit | lookfor\");\r\n\t\t\t}\r\n\t\t\tconst amount = parseInt(amountStr);\r\n\t\t\tif (!amount || amount < 20 || amount > 100) {\r\n\t\t\t\treturn this.errorReply(\"Please enter a valid amount. For a GTS giveaway, you need to give away at least 20 mons, and no more than 100.\");\r\n\t\t\t}\r\n\t\t\tconst targetUser = Users.get(giver);\r\n\t\t\tif (!targetUser?.connected) return this.errorReply(`User '${giver}' is not online.`);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\tif (!targetUser.autoconfirmed) {\r\n\t\t\t\treturn this.errorReply(`User '${targetUser.name}' needs to be autoconfirmed to host a giveaway.`);\r\n\t\t\t}\r\n\t\t\tif (Giveaway.checkBanned(room, targetUser)) return this.errorReply(`User '${targetUser.name}' is giveaway banned.`);\r\n\r\n\t\t\troom.subGame = new GTS(room, targetUser, amount, summary, deposit, lookfor);\r\n\r\n\t\t\tthis.privateModAction(`${user.name} started a GTS giveaway for ${targetUser.name} with ${amount} Pok\u00E9mon`);\r\n\t\t\tthis.modlog('GTS GIVEAWAY', null, `for ${targetUser.getLastId()} with ${amount} Pok\u00E9mon`);\r\n\t\t\t*/\r\n\t\t},\r\n\t\tleft(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst game = this.requireGame(GTS, true);\r\n\t\t\tif (!user.can('warn', null, room) && user !== game.giver) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(\"Only the host or a staff member can update GTS giveaways.\");\r\n\t\t\t}\r\n\t\t\tif (!target) {\r\n\t\t\t\tthis.runBroadcast();\r\n\t\t\t\tlet output = `The GTS giveaway from ${game.giver} has ${game.left} Pok\u00E9mon remaining!`;\r\n\t\t\t\tif (game.sent.length) output += `Last winners: ${game.sent.join(', ')}`;\r\n\t\t\t\treturn this.sendReply(output);\r\n\t\t\t}\r\n\t\t\tconst newamount = parseInt(target);\r\n\t\t\tif (isNaN(newamount)) return this.errorReply(\"Please enter a valid amount.\");\r\n\t\t\tif (newamount > game.left) return this.errorReply(\"The new amount must be lower than the old amount.\");\r\n\t\t\tif (newamount < game.left - 1) {\r\n\t\t\t\tthis.modlog(`GTS GIVEAWAY`, null, `set from ${game.left} to ${newamount} left`);\r\n\t\t\t}\r\n\r\n\t\t\tgame.updateLeft(newamount);\r\n\t\t},\r\n\t\tsent(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst game = this.requireGame(GTS, true);\r\n\t\t\tif (!user.can('warn', null, room) && user !== game.giver) {\r\n\t\t\t\treturn this.errorReply(\"Only the host or a staff member can update GTS giveaways.\");\r\n\t\t\t}\r\n\r\n\t\t\tif (!target || target.length > 12) return this.errorReply(\"Please enter a valid IGN.\");\r\n\r\n\t\t\tgame.updateSent(target);\r\n\t\t},\r\n\t\tfull(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst game = this.requireGame(GTS, true);\r\n\t\t\tif (!user.can('warn', null, room) && user !== game.giver) {\r\n\t\t\t\treturn this.errorReply(\"Only the host or a staff member can update GTS giveaways.\");\r\n\t\t\t}\r\n\t\t\tif (game.noDeposits) return this.errorReply(\"The GTS giveaway was already set to not accept deposits.\");\r\n\r\n\t\t\tgame.stopDeposits();\r\n\t\t},\r\n\t\tend(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst game = this.requireGame(GTS, true);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\r\n\t\t\tif (target && target.length > 300) {\r\n\t\t\t\treturn this.errorReply(\"The reason is too long. It cannot exceed 300 characters.\");\r\n\t\t\t}\r\n\t\t\tconst amount = game.end(true);\r\n\t\t\tif (target) target = `: ${target}`;\r\n\t\t\tthis.modlog('GTS END', null, `with ${amount} left${target}`);\r\n\t\t\tthis.privateModAction(`The giveaway was forcibly ended by ${user.name} with ${amount} left${target}`);\r\n\t\t},\r\n\t},\r\n\tgtshelp: [\r\n\t\t`GTS giveaways are currently disabled. If you are a Room Owner and would like them to be re-enabled, contact Kris.`,\r\n\t],\r\n\tga: 'giveaway',\r\n\tgiveaway: {\r\n\t\thelp: '',\r\n\t\t''() {\r\n\t\t\tthis.runBroadcast();\r\n\t\t\tthis.run('giveawayhelp');\r\n\t\t},\r\n\t\tview: {\r\n\t\t\t''(target, room, user) {\r\n\t\t\t\tthis.room = room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) throw new Chat.ErrorMessage(`The Wi-Fi room doesn't exist on this server.`);\r\n\t\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\t\tthis.parse(`/j view-giveaways-default`);\r\n\t\t\t},\r\n\t\t\tstored(target, room, user) {\r\n\t\t\t\tthis.room = room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) throw new Chat.ErrorMessage(`The Wi-Fi room doesn't exist on this server.`);\r\n\t\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\t\tthis.parse(`/j view-giveaways-stored`);\r\n\t\t\t},\r\n\t\t\tsubmitted(target, room, user) {\r\n\t\t\t\tthis.room = room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) throw new Chat.ErrorMessage(`The Wi-Fi room doesn't exist on this server.`);\r\n\t\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\t\tthis.parse(`/j view-giveaways-submitted`);\r\n\t\t\t},\r\n\t\t},\r\n\t\trm: 'remind',\r\n\t\tremind(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.runBroadcast();\r\n\t\t\tif (room.getGame(QuestionGiveaway)) {\r\n\t\t\t\tconst game = room.getGame(QuestionGiveaway)!;\r\n\t\t\t\tif (game.phase !== 'started') {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`The giveaway has not started yet.`);\r\n\t\t\t\t}\r\n\t\t\t\tgame.send(game.generateQuestion());\r\n\t\t\t} else if (room.getGame(LotteryGiveaway)) {\r\n\t\t\t\troom.getGame(LotteryGiveaway)!.display();\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`There is no giveaway going on right now.`);\r\n\t\t\t}\r\n\t\t},\r\n\t\tleavelotto: 'join',\r\n\t\tleavelottery: 'join',\r\n\t\tleave: 'join',\r\n\t\tjoinlotto: 'join',\r\n\t\tjoinlottery: 'join',\r\n\t\tjoin(target, room, user, conn, cmd) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkChat();\r\n\t\t\tif (user.semilocked) return;\r\n\t\t\tconst giveaway = this.requireGame(LotteryGiveaway);\r\n\t\t\tif (cmd.includes('join')) {\r\n\t\t\t\tgiveaway.addUser(user);\r\n\t\t\t} else {\r\n\t\t\t\tgiveaway.removeUser(user);\r\n\t\t\t}\r\n\t\t},\r\n\t\tban(target, room, user) {\r\n\t\t\tif (!target) return false;\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\r\n\t\t\tconst {targetUser, rest: reason} = this.requireUser(target, {allowOffline: true});\r\n\t\t\tif (reason.length > 300) {\r\n\t\t\t\treturn this.errorReply(\"The reason is too long. It cannot exceed 300 characters.\");\r\n\t\t\t}\r\n\t\t\tif (Punishments.hasRoomPunishType(room, targetUser.name, 'GIVEAWAYBAN')) {\r\n\t\t\t\treturn this.errorReply(`User '${targetUser.name}' is already giveawaybanned.`);\r\n\t\t\t}\r\n\r\n\t\t\tGiveaway.ban(room, targetUser, reason);\r\n\t\t\t(room.getGame(LotteryGiveaway) || room.getGame(QuestionGiveaway))?.kickUser(targetUser);\r\n\t\t\tthis.modlog('GIVEAWAYBAN', targetUser, reason);\r\n\t\t\tconst reasonMessage = reason ? ` (${reason})` : ``;\r\n\t\t\tthis.privateModAction(`${targetUser.name} was banned from entering giveaways by ${user.name}.${reasonMessage}`);\r\n\t\t},\r\n\t\tunban(target, room, user) {\r\n\t\t\tif (!target) return false;\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\r\n\t\t\tconst {targetUser} = this.requireUser(target, {allowOffline: true});\r\n\t\t\tif (!Giveaway.checkBanned(room, targetUser)) {\r\n\t\t\t\treturn this.errorReply(`User '${targetUser.name}' isn't banned from entering giveaways.`);\r\n\t\t\t}\r\n\r\n\t\t\tGiveaway.unban(room, targetUser);\r\n\t\t\tthis.privateModAction(`${targetUser.name} was unbanned from entering giveaways by ${user.name}.`);\r\n\t\t\tthis.modlog('GIVEAWAYUNBAN', targetUser, null, {noip: 1, noalts: 1});\r\n\t\t},\r\n\t\tnew: 'create',\r\n\t\tstart: 'create',\r\n\t\tcreate: {\r\n\t\t\t''(target, room, user) {\r\n\t\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\t\tif (!user.can('show', null, room)) this.checkCan('warn', null, room);\r\n\t\t\t\tthis.parse('/j view-giveaways-create');\r\n\t\t\t},\r\n\t\t\tquestion(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tif (room.game) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`There is already a room game (${room.game.constructor.name}) going on.`);\r\n\t\t\t\t}\r\n\t\t\t\t// Syntax: giver|ot|tid|game|question|answer1,answer2,etc|ivs/format/like/this|pokeball|packed set\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, question, answers, ivs, ball, extraInfo, prize,\r\n\t\t\t\t} = QuestionGiveaway.splitTarget(target, '|', this, user, 'create');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\troom.game = new QuestionGiveaway(user, targetUser, room, ot, tid, game, ivs, set, question, answers, ball, extraInfo);\r\n\r\n\t\t\t\tthis.privateModAction(`${user.name} started a question giveaway for ${targetUser.name}.`);\r\n\t\t\t\tthis.modlog('QUESTION GIVEAWAY', null, `for ${targetUser.getLastId()} (OT: ${ot} TID: ${tid} Nature: ${(room.game as LotteryGiveaway).prize.nature} Ball: ${ball}${extraInfo ? ` Other box info: ${extraInfo}` : ''})`);\r\n\t\t\t},\r\n\t\t\tlottery(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tif (room.game) throw new Chat.ErrorMessage(`There is already a room game (${room.game.constructor.name}) going on.`);\r\n\t\t\t\t// Syntax: giver|ot|tid|game|# of winners|ivs/like/this|pokeball|info|packed set\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, winners, ivs, ball, prize, extraInfo,\r\n\t\t\t\t} = LotteryGiveaway.splitTarget(target, '|', this, user, 'create');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\troom.game = new LotteryGiveaway(user, targetUser, room, ot, tid, ivs, game, set, winners, ball, extraInfo);\r\n\r\n\t\t\t\tthis.privateModAction(`${user.name} started a lottery giveaway for ${targetUser.name}.`);\r\n\t\t\t\tthis.modlog('LOTTERY GIVEAWAY', null, `for ${targetUser.getLastId()} (OT: ${ot} TID: ${tid} Nature: ${(room.game as LotteryGiveaway).prize.nature} Ball: ${ball}${extraInfo ? ` Other box info: ${extraInfo}` : ''})`);\r\n\t\t\t},\r\n\t\t},\r\n\t\tstop: 'end',\r\n\t\tend(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tif (!room.game?.constructor.name.includes('Giveaway')) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`There is no giveaway going on at the moment.`);\r\n\t\t\t}\r\n\t\t\tconst game = room.game as LotteryGiveaway | QuestionGiveaway;\r\n\t\t\tif (user.id !== game.host.id) this.checkCan('warn', null, room);\r\n\r\n\t\t\tif (target && target.length > 300) {\r\n\t\t\t\treturn this.errorReply(\"The reason is too long. It cannot exceed 300 characters.\");\r\n\t\t\t}\r\n\t\t\tgame.end(true);\r\n\t\t\tthis.modlog('GIVEAWAY END', null, target);\r\n\t\t\tif (target) target = `: ${target}`;\r\n\t\t\tthis.privateModAction(`The giveaway was forcibly ended by ${user.name}${target}`);\r\n\t\t},\r\n\t\tguess(target, room, user) {\r\n\t\t\tthis.parse(`/guess ${target}`);\r\n\t\t},\r\n\t\tchangeanswer: 'changequestion',\r\n\t\tchangequestion(target, room, user, connection, cmd) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst giveaway = this.requireGame(QuestionGiveaway);\r\n\t\t\ttarget = target.trim();\r\n\t\t\tif (!target) throw new Chat.ErrorMessage(\"You must include a question or an answer.\");\r\n\t\t\tgiveaway.change(target, user, cmd.includes('answer'));\r\n\t\t},\r\n\t\tshowanswer: 'viewanswer',\r\n\t\tviewanswer(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tconst giveaway = this.requireGame(QuestionGiveaway);\r\n\t\t\tif (user.id !== giveaway.host.id && user.id !== giveaway.giver.id) return;\r\n\r\n\t\t\tthis.sendReply(`The giveaway question is ${giveaway.question}.\\nThe answer${Chat.plural(giveaway.answers, 's are', ' is')} ${giveaway.answers.join(', ')}.`);\r\n\t\t},\r\n\t\tsave: 'store',\r\n\t\tstore: {\r\n\t\t\t''(target, room, user) {\r\n\t\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\t\tthis.parse('/j view-giveaways-stored-add');\r\n\t\t\t},\r\n\t\t\tquestion(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, prize, question, answers, ball, extraInfo, ivs,\r\n\t\t\t\t} = QuestionGiveaway.splitTarget(target, '|', this, user, 'store');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\tif (!wifiData.storedGiveaways.question) wifiData.storedGiveaways.question = [];\r\n\t\t\t\tconst data = {targetUserID: targetUser.id, ot, tid, game, prize: set, question, answers, ivs, ball, extraInfo};\r\n\t\t\t\twifiData.storedGiveaways.question.push(data);\r\n\t\t\t\tsaveData();\r\n\r\n\t\t\t\tthis.privateModAction(`${user.name} saved a question giveaway for ${targetUser.name}.`);\r\n\t\t\t\tthis.modlog('QUESTION GIVEAWAY SAVE');\r\n\t\t\t},\r\n\t\t\tlottery(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, prize, winners, ball, extraInfo, ivs,\r\n\t\t\t\t} = LotteryGiveaway.splitTarget(target, '|', this, user, 'store');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\tif (!wifiData.storedGiveaways.lottery) wifiData.storedGiveaways.lottery = [];\r\n\t\t\t\tconst data = {targetUserID: targetUser.id, ot, tid, game, prize: set, winners, ball, extraInfo, ivs};\r\n\t\t\t\twifiData.storedGiveaways.lottery.push(data);\r\n\t\t\t\tsaveData();\r\n\r\n\t\t\t\tthis.privateModAction(`${user.name} saved a lottery giveaway for ${targetUser.name}.`);\r\n\t\t\t\tthis.modlog('LOTTERY GIVEAWAY SAVE');\r\n\t\t\t},\r\n\t\t},\r\n\t\tsubmit: {\r\n\t\t\t''(target, room, user) {\r\n\t\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\t\tthis.checkChat();\r\n\t\t\t\tthis.parse('/j view-giveaways-submitted-add');\r\n\t\t\t},\r\n\t\t\tquestion(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, prize, question, answers, ball, extraInfo, ivs,\r\n\t\t\t\t} = QuestionGiveaway.splitTarget(target, '|', this, user, 'submit');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\tif (!wifiData.submittedGiveaways.question) wifiData.submittedGiveaways.question = [];\r\n\t\t\t\tconst data = {targetUserID: targetUser.id, ot, tid, game, prize: set, question, answers, ball, extraInfo, ivs};\r\n\t\t\t\twifiData.submittedGiveaways.question.push(data);\r\n\t\t\t\tsaveData();\r\n\r\n\t\t\t\tthis.sendReply(`You have submitted a question giveaway for ${set.species}. If you log out or go offline, the giveaway won't go through.`);\r\n\t\t\t\tconst message = `|tempnotify|pendingapprovals|Pending question giveaway request!` +\r\n\t\t\t\t\t`|${user.name} has requested to start a question giveaway for ${set.species}.|new question giveaway request`;\r\n\t\t\t\troom.sendRankedUsers(message, '%');\r\n\t\t\t\troom.sendMods(\r\n\t\t\t\t\tChat.html`|uhtml|giveaway-request-${user.id}|${<div class=\"infobox\">\r\n\t\t\t\t\t\t{user.name} wants to start a question giveaway for {set.species}<br />\r\n\t\t\t\t\t\t<button class=\"button\" name=\"send\" value=\"/j view-giveaways-submitted\">View pending giveaways</button>\r\n\t\t\t\t\t</div>}`\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tlottery(target, room, user) {\r\n\t\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\t\tif (!room) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t\t}\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttargetUser, ot, tid, game, prize, winners, ball, extraInfo, ivs,\r\n\t\t\t\t} = LotteryGiveaway.splitTarget(target, '|', this, user, 'submit');\r\n\t\t\t\tconst set = Teams.import(prize)?.[0];\r\n\t\t\t\tif (!set) throw new Chat.ErrorMessage(`Please submit the prize in the form of a PS set importable.`);\r\n\r\n\t\t\t\tif (!wifiData.submittedGiveaways.lottery) wifiData.submittedGiveaways.lottery = [];\r\n\t\t\t\tconst data = {targetUserID: targetUser.id, ot, tid, game, prize: set, winners, ball, extraInfo, ivs};\r\n\t\t\t\twifiData.submittedGiveaways.lottery.push(data);\r\n\t\t\t\tsaveData();\r\n\r\n\t\t\t\tthis.sendReply(`You have submitted a lottery giveaway for ${set.species}. If you log out or go offline, the giveaway won't go through.`);\r\n\t\t\t\tconst message = `|tempnotify|pendingapprovals|Pending lottery giveaway request!` +\r\n\t\t\t\t\t`|${user.name} has requested to start a lottery giveaway for ${set.species}.|new lottery giveaway request`;\r\n\t\t\t\troom.sendRankedUsers(message, '%');\r\n\t\t\t\troom.sendMods(Chat.html`|uhtml|giveaway-request-${user.id}|${<div class=\"infobox\">\r\n\t\t\t\t\t{user.name} wants to start a lottery giveaway for {set.species}<br />\r\n\t\t\t\t\t<button class=\"button\" name=\"send\" value=\"/j view-giveaways-submitted\">View pending giveaways</button>\r\n\t\t\t\t</div>}`);\r\n\t\t\t},\r\n\t\t},\r\n\t\tapprove(target, room, user) {\r\n\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\tif (!room) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t}\r\n\t\t\tconst targetUser = Users.get(target);\r\n\t\t\tif (!targetUser?.connected) {\r\n\t\t\t\tthis.refreshPage('giveaways-submitted');\r\n\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} is offline, so their giveaway can't be run.`);\r\n\t\t\t}\r\n\t\t\tconst hasGiveaway = hasSubmittedGiveaway(targetUser);\r\n\t\t\tif (!hasGiveaway) {\r\n\t\t\t\tthis.refreshPage('giveaways-submitted');\r\n\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} doesn't have any submitted giveaways.`);\r\n\t\t\t}\r\n\t\t\tconst giveaway = wifiData.submittedGiveaways[hasGiveaway.type][hasGiveaway.index];\r\n\t\t\tif (hasGiveaway.type === 'question') {\r\n\t\t\t\tconst data = giveaway as QuestionGiveawayData;\r\n\t\t\t\tthis.parse(`/giveaway create question ${data.targetUserID}|${data.ot}|${data.tid}|${data.game}|${data.question}|${data.answers.join(',')}|${data.ivs.join('/')}|${data.ball}|${data.extraInfo}|${Teams.pack([data.prize])!}`);\r\n\t\t\t} else {\r\n\t\t\t\tconst data = giveaway as LotteryGiveawayData;\r\n\t\t\t\tthis.parse(`/giveaway create lottery ${data.targetUserID}|${data.ot}|${data.tid}|${data.game}|${data.winners}|${data.ivs.join('/')}|${data.ball}|${data.extraInfo}|${Teams.pack([data.prize])!}`);\r\n\t\t\t}\r\n\t\t\twifiData.submittedGiveaways[hasGiveaway.type].splice(hasGiveaway.index, 1);\r\n\t\t\tsaveData();\r\n\t\t\tthis.refreshPage(`giveaways-submitted`);\r\n\t\t\ttargetUser.send(`${user.name} has approved your ${hasGiveaway.type} giveaway!`);\r\n\t\t\tthis.privateModAction(`${user.name} approved a ${hasGiveaway.type} giveaway by ${targetUser.name}.`);\r\n\t\t\tthis.modlog(`GIVEAWAY APPROVE ${hasGiveaway.type.toUpperCase()}`, targetUser, null, {noalts: true, noip: true});\r\n\t\t},\r\n\t\tdeny: 'delete',\r\n\t\tdelete(target, room, user, connection, cmd) {\r\n\t\t\troom = this.room = Rooms.search('wifi') || null;\r\n\t\t\tif (!room) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`This command must be used in the Wi-Fi room.`);\r\n\t\t\t}\r\n\t\t\tif (!target) return this.parse('/help giveaway');\r\n\t\t\tconst del = cmd === 'delete';\r\n\t\t\tif (del) {\r\n\t\t\t\tconst [type, indexStr] = target.split(',');\r\n\t\t\t\tconst index = parseInt(indexStr) - 1;\r\n\t\t\t\tif (!type || !indexStr || index <= -1 || !['question', 'lottery'].includes(toID(type)) || isNaN(index)) {\r\n\t\t\t\t\treturn this.parse(`/help giveaway`);\r\n\t\t\t\t}\r\n\t\t\t\tconst typedType = toID(type) as 'question' | 'lottery';\r\n\t\t\t\tconst giveaway = wifiData.storedGiveaways[typedType][index];\r\n\t\t\t\tif (!giveaway) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(\r\n\t\t\t\t\t\t`There is no giveaway at index ${index}. Indices must be integers between 0 and ${wifiData.storedGiveaways[typedType].length - 1}.`\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\twifiData.storedGiveaways[typedType].splice(index, 1);\r\n\t\t\t\tsaveData();\r\n\t\t\t\tthis.privateModAction(`${user.name} deleted a ${typedType} giveaway by ${giveaway.targetUserID}.`);\r\n\t\t\t\tthis.modlog(`GIVEAWAY DELETE ${typedType.toUpperCase()}`);\r\n\t\t\t} else {\r\n\t\t\t\tconst {targetUser, rest: reason} = this.splitUser(target);\r\n\t\t\t\tif (!targetUser?.connected) {\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} is offline, so their giveaway can't be run.`);\r\n\t\t\t\t}\r\n\t\t\t\tconst hasGiveaway = hasSubmittedGiveaway(targetUser);\r\n\t\t\t\tif (!hasGiveaway) {\r\n\t\t\t\t\tthis.refreshPage('giveaways-submitted');\r\n\t\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} doesn't have any submitted giveaways.`);\r\n\t\t\t\t}\r\n\t\t\t\twifiData.submittedGiveaways[hasGiveaway.type].splice(hasGiveaway.index, 1);\r\n\t\t\t\tsaveData();\r\n\t\t\t\ttargetUser?.send(`Staff have rejected your giveaway${reason ? `: ${reason}` : '.'}`);\r\n\t\t\t\tthis.privateModAction(`${user.name} denied a ${hasGiveaway.type} giveaway by ${targetUser.name}.`);\r\n\t\t\t\tthis.modlog(`GIVEAWAY DENY ${hasGiveaway.type.toUpperCase()}`, targetUser, reason || null, {noalts: true, noip: true});\r\n\t\t\t}\r\n\t\t\tthis.refreshPage(del ? `giveaways-stored` : 'giveaways-submitted');\r\n\t\t},\r\n\t\tunwhitelist: 'whitelist',\r\n\t\twhitelist(target, room, user, connection, cmd) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\tconst targetId = toID(target);\r\n\t\t\tif (!targetId) return this.parse(`/help giveaway whitelist`);\r\n\t\t\tif (cmd.includes('un')) {\r\n\t\t\t\tconst idx = wifiData.whitelist.indexOf(targetId);\r\n\t\t\t\tif (idx < 0) {\r\n\t\t\t\t\treturn this.errorReply(`'${targetId}' is not whitelisted.`);\r\n\t\t\t\t}\r\n\t\t\t\twifiData.whitelist.splice(idx, 1);\r\n\t\t\t\tthis.privateModAction(`${user.name} removed '${targetId}' from the giveaway whitelist.`);\r\n\t\t\t\tthis.modlog(`GIVEAWAY UNWHITELIST`, targetId);\r\n\t\t\t\tsaveData();\r\n\t\t\t} else {\r\n\t\t\t\tif (wifiData.whitelist.includes(targetId)) {\r\n\t\t\t\t\treturn this.errorReply(`'${targetId}' is already whitelisted.`);\r\n\t\t\t\t}\r\n\t\t\t\twifiData.whitelist.push(targetId);\r\n\t\t\t\tthis.privateModAction(`${user.name} added ${targetId} to the giveaway whitelist.`);\r\n\t\t\t\tthis.modlog(`GIVEAWAY WHITELIST`, targetId);\r\n\t\t\t\tsaveData();\r\n\t\t\t}\r\n\t\t},\r\n\t\twhitelisthelp: [\r\n\t\t\t`/giveaway whitelist [user] - Allow the given [user] to make giveaways without staff help. Requires: % @ # &`,\r\n\t\t\t`/giveaway unwhitelist [user] - Remove the given user from the giveaway whitelist. Requires: % @ # &`,\r\n\t\t],\r\n\t\twhitelisted(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('warn', null, room);\r\n\t\t\tconst buf = [<strong>Currently whitelisted users</strong>, <br />];\r\n\t\t\tif (!wifiData.whitelist.length) {\r\n\t\t\t\tbuf.push(<div class=\"message-error\">None.</div>);\r\n\t\t\t} else {\r\n\t\t\t\tbuf.push(wifiData.whitelist.map(n => <username>{n}</username>));\r\n\t\t\t}\r\n\t\t\tthis.sendReplyBox(<>{buf}</>);\r\n\t\t},\r\n\t\tclaim(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('mute', null, room);\r\n\t\t\tconst {targetUser} = this.requireUser(target);\r\n\t\t\tconst hasGiveaway = hasSubmittedGiveaway(targetUser);\r\n\t\t\tif (!hasGiveaway) {\r\n\t\t\t\tthis.refreshPage('giveaways-submitted');\r\n\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} doesn't have any submitted giveaways.`);\r\n\t\t\t}\r\n\t\t\t// we ensure it exists above\r\n\t\t\tconst giveaway = wifiData.submittedGiveaways[hasGiveaway.type][hasGiveaway.index];\r\n\t\t\tif (giveaway.claimed) throw new Chat.ErrorMessage(`That giveaway is already claimed by ${giveaway.claimed}.`);\r\n\t\t\tgiveaway.claimed = user.id;\r\n\t\t\tChat.refreshPageFor('giveaways-submitted', room);\r\n\t\t\tthis.privateModAction(`${user.name} claimed ${targetUser.name}'s giveaway`);\r\n\t\t\tsaveData();\r\n\t\t},\r\n\t\tunclaim(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tthis.checkCan('mute', null, room);\r\n\t\t\tconst {targetUser} = this.requireUser(target);\r\n\t\t\tconst hasGiveaway = hasSubmittedGiveaway(targetUser);\r\n\t\t\tif (!hasGiveaway) {\r\n\t\t\t\tthis.refreshPage('giveaways-submitted');\r\n\t\t\t\tthrow new Chat.ErrorMessage(`${targetUser?.name || toID(target)} doesn't have any submitted giveaways.`);\r\n\t\t\t}\r\n\t\t\t// we ensure it exists above\r\n\t\t\tconst giveaway = wifiData.submittedGiveaways[hasGiveaway.type][hasGiveaway.index];\r\n\t\t\tif (!giveaway.claimed) throw new Chat.ErrorMessage(`That giveaway is not claimed.`);\r\n\t\t\tdelete giveaway.claimed;\r\n\t\t\tChat.refreshPageFor('giveaways-submitted', room);\r\n\t\t\tsaveData();\r\n\t\t},\r\n\t\tcount(target, room, user) {\r\n\t\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\t\tif (!Dex.species.get(target).exists) {\r\n\t\t\t\tthrow new Chat.ErrorMessage(`No Pok\\u00e9mon entered. Proper syntax: /giveaway count pokemon`);\r\n\t\t\t}\r\n\t\t\ttarget = Dex.species.get(target).id;\r\n\t\t\tthis.runBroadcast();\r\n\r\n\t\t\tconst count = wifiData.stats[target];\r\n\r\n\t\t\tif (!count) return this.sendReplyBox(\"This Pok\u00E9mon has never been given away.\");\r\n\t\t\tconst recent = count.filter(val => val + RECENT_THRESHOLD > Date.now()).length;\r\n\r\n\t\t\tthis.sendReplyBox(`This Pok\u00E9mon has been given away ${Chat.count(count, \"times\")}, a total of ${Chat.count(recent, \"times\")} in the past month.`);\r\n\t\t},\r\n\t},\r\n\tgiveawayhelp(target, room, user) {\r\n\t\troom = this.requireRoom('wifi' as RoomID);\r\n\t\tthis.runBroadcast();\r\n\t\tconst buf = [];\r\n\t\tif (user.can('show', null, room)) {\r\n\t\t\tbuf.push(<details><summary>Staff commands</summary>\r\n\t\t\t\t<code>/giveaway create</code> - Pulls up a page to create a giveaway. Requires: + % @ # &amp;<br />\r\n\t\t\t\t<code>\r\n\t\t\t\t\t/giveaway create question Giver | OT | TID | Game | Question | Answer 1, Answer 2, Answer 3 | IV/IV/IV/IV/IV/IV | Pok&eacute; Ball | Extra Info | Prize\r\n\t\t\t\t</code> - Start a new question giveaway (voices can only host their own). Requires: + % @ # &amp;<br />\r\n\t\t\t\t<code>\r\n\t\t\t\t\t/giveaway create lottery Giver | OT | TID | Game | # of Winners | IV/IV/IV/IV/IV/IV | Pok&eacute; Ball | Extra Info | Prize\r\n\t\t\t\t</code> - Start a new lottery giveaway (voices can only host their own). Requires: + % @ # &amp;<br />\r\n\t\t\t\t<code>\r\n\t\t\t\t\t/giveaway changequestion/changeanswer\r\n\t\t\t\t</code> - Changes the question/answer of a question giveaway. Requires: Being giveaway host<br />\r\n\t\t\t\t<code>/giveaway viewanswer</code> - Shows the answer of a question giveaway. Requires: Being giveaway host/giver<br />\r\n\t\t\t\t<code>\r\n\t\t\t\t\t/giveaway ban [user], [reason]\r\n\t\t\t\t</code> - Temporarily bans [user] from entering giveaways. Requires: % @ # &amp;<br />\r\n\t\t\t\t<code>/giveaway end</code> - Forcibly ends the current giveaway. Requires: % @ # &amp;<br />\r\n\t\t\t\t<code>/giveaway count [pokemon]</code> - Shows how frequently a certain Pok&eacute;mon has been given away.<br />\r\n\t\t\t\t<code>/giveaway whitelist [user]</code> - Allow the given [user] to make giveaways. Requires: % @ # &amp;<br />\r\n\t\t\t\t<code>/giveaway unwhitelist [user]</code> - Remove the given user from the giveaway whitelist. Requires: % @ # &amp;\r\n\t\t\t</details>);\r\n\t\t}\r\n\t\t// Giveaway stuff\r\n\t\tbuf.push(<details><summary>Giveaway participation commands</summary>\r\n\t\t\t<code>/guess [target]</code> - Guesses an answer for a question giveaway.<br />\r\n\t\t\t<code>\r\n\t\t\t\t/giveaway submit\r\n\t\t\t</code> - Allows users to submit giveaways. They must remain online after submitting for it to go through.<br />\r\n\t\t\t<code>/giveaway viewanswer</code> - Guesses an answer for a question giveaway. Requires: Giveaway host/giver<br />\r\n\t\t\t<code>/giveaway remind</code> - Shows the details of the current giveaway.<br />\r\n\t\t\t<code>/giveaway join/leave</code> - Joins/leaves a lottery giveaway.\r\n\t\t</details>);\r\n\t\tthis.sendReplyBox(<>{buf}</>);\r\n\t},\r\n};\r\n\r\nfunction makePageHeader(user: User, pageid?: string) {\r\n\tconst titles: {[k: string]: string} = {\r\n\t\tcreate: `Create`,\r\n\t\tstored: `View Stored`,\r\n\t\t'stored-add': 'Store',\r\n\t\tsubmitted: `View Submitted`,\r\n\t\t'submitted-add': `Submit`,\r\n\t};\r\n\tconst icons: Record<keyof typeof titles, Chat.VNode> = {\r\n\t\tcreate: <i class=\"fa fa-sticky-note\"></i>,\r\n\t\tstored: <i class=\"fa fa-paste\"></i>,\r\n\t\t'stored-add': <i class=\"fa fa-paste\"></i>,\r\n\t\tsubmitted: <i class=\"fa fa-inbox\"></i>,\r\n\t\t'submitted-add': <i class=\"fa fa-inbox\"></i>,\r\n\t};\r\n\tconst buf = [];\r\n\tbuf.push(<button class=\"button\" style={{float: 'right'}} name=\"send\" value={\r\n\t\t`/j view-giveaways${pageid?.trim() ? `-${pageid.trim()}` : ''}`\r\n\t}>\r\n\t\t<i class=\"fa fa-refresh\"></i> Refresh\r\n\t</button>);\r\n\tbuf.push(<h1>Wi-Fi Giveaways</h1>);\r\n\tconst urls = [];\r\n\tconst room = Rooms.get('wifi')!; // we validate before using that wifi exists\r\n\tfor (const i in titles) {\r\n\t\tif (urls.length) urls.push(' / ');\r\n\t\tif (!user.can('mute', null, room) && i !== 'submitted-add') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tconst title = titles[i];\r\n\t\tconst icon = icons[i];\r\n\t\tif (pageid === i) {\r\n\t\t\turls.push(<>{icon} <strong>{title}</strong></>);\r\n\t\t} else {\r\n\t\t\turls.push(<>{icon} <a href={`/view-giveaways-${i}`} target=\"replace\">{title}</a></>);\r\n\t\t}\r\n\t}\r\n\tbuf.push(<>{[urls]}</>, <hr />);\r\n\treturn <center>{buf}</center>;\r\n}\r\n\r\nfunction formatFakeButton(url: string, text: Chat.VNode): Chat.VNode {\r\n\treturn <a class=\"button\" style={{textDecoration: 'inherit'}} target=\"replace\" href={url}>{text}</a>;\r\n}\r\n\r\nfunction generatePokeballDropdown() {\r\n\tconst pokeballs = Dex.items.all().filter(item => item.isPokeball).sort((a, b) => a.num - b.num);\r\n\tconst pokeballsObj = [<option value=\"\">Please select a Pok&eacute; Ball</option>];\r\n\tfor (const pokeball of pokeballs) {\r\n\t\tpokeballsObj.push(<option value={pokeball.id}>{pokeball.name}</option>);\r\n\t}\r\n\treturn <><label for=\"ball\">Pok&eacute; Ball type: </label><select name=\"ball\">{pokeballsObj}</select></>;\r\n}\r\n\r\nexport const pages: Chat.PageTable = {\r\n\tgiveaways: {\r\n\t\t''() {\r\n\t\t\tthis.title = `[Giveaways]`;\r\n\t\t\tif (!Rooms.search('wifi')) return <h1>There is no Wi-Fi room on this server.</h1>;\r\n\t\t\tthis.checkCan('warn', null, Rooms.search('wifi')!);\r\n\t\t\treturn <div class=\"pad\">{makePageHeader(this.user)}</div>;\r\n\t\t},\r\n\t\tcreate(args, user) {\r\n\t\t\tthis.title = `[Create Giveaways]`;\r\n\t\t\tconst wifi = Rooms.search('wifi');\r\n\t\t\tif (!wifi) return <h1>There is no Wi-Fi room on this server.</h1>;\r\n\t\t\tif (!(user.can('show', null, wifi) || wifiData.whitelist.includes(user.id))) {\r\n\t\t\t\tthis.checkCan('warn', null, wifi);\r\n\t\t\t}\r\n\t\t\tconst [type] = args;\r\n\t\t\treturn <div class=\"pad\">{makePageHeader(this.user, 'create')}{(() => {\r\n\t\t\t\tif (!type || !['lottery', 'question'].includes(type)) {\r\n\t\t\t\t\treturn <center>\r\n\t\t\t\t\t\t<h2>Pick a Giveaway type</h2>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-create-lottery`, <><i class=\"fa fa-random\"></i> Lottery</>)\r\n\t\t\t\t\t\t} | {\r\n\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-create-question`, <><i class=\"fa fa-question\"></i> Question</>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</center>;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\tcase 'lottery':\r\n\t\t\t\t\treturn <>\r\n\t\t\t\t\t\t<h2>Make a Lottery Giveaway</h2>\r\n\t\t\t\t\t\t<form data-submitsend={\"/giveaway create lottery {giver}|{ot}|{tid}|{game}|{winners}|{ivs}|{ball}|{info}|{set}\"}>\r\n\t\t\t\t\t\t\t<label for=\"giver\">Giver: </label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"ot\">OT: </label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"tid\">TID: </label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\" value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t<label for=\"winners\">Number of winners: </label><input name=\"winners\" /><br /><br />\r\n\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"set\">Prize:</label><br />\r\n\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable\" name=\"set\"></textarea><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"info\">Additional information (if any):</label><br />\r\n\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Create Lottery Giveaway</button>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</>;\r\n\t\t\t\tcase 'question':\r\n\t\t\t\t\treturn <>\r\n\t\t\t\t\t\t<h2>Make a Question Giveaway</h2>\r\n\t\t\t\t\t\t<form data-submitsend={\r\n\t\t\t\t\t\t\t\"/giveaway create question {giver}|{ot}|{tid}|{game}|{question}|{answers}|{ivs}|{ball}|{info}|{set}\"\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t<label for=\"giver\">Giver:</label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"ot\">OT:</label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"tid\">TID:</label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\"value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t<label for=\"question\">Question:</label><input name=\"question\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"answers\">Answers (separated by comma):</label><input name=\"answers\" /><br /><br />\r\n\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t<label for=\"set\"></label>\r\n\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable here\" name=\"set\"></textarea>\r\n\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t<label for=\"info\">Additional information (if any):</label><br />\r\n\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Create Question Giveaway</button>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t}\r\n\t\t\t})()}</div>;\r\n\t\t},\r\n\t\tstored(args, user) {\r\n\t\t\tthis.title = `[Stored Giveaways]`;\r\n\t\t\tif (!Rooms.search('wifi')) return <h1>There is no Wi-Fi room on this server.</h1>;\r\n\t\t\tthis.checkCan('warn', null, Rooms.search('wifi')!);\r\n\t\t\tconst [add, type] = args;\r\n\t\t\tconst giveaways = [\r\n\t\t\t\t...((wifiData.storedGiveaways || {}).lottery || []),\r\n\t\t\t\t...((wifiData.storedGiveaways || {}).question || []),\r\n\t\t\t];\r\n\t\t\tconst adding = add === 'add';\r\n\t\t\tif (!giveaways.length && !adding) {\r\n\t\t\t\treturn <div class=\"pad\">\r\n\t\t\t\t\t{makePageHeader(this.user, adding ? 'stored-add' : 'stored')}\r\n\t\t\t\t\t<h2>There are no giveaways stored</h2>\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t\treturn <div class=\"pad\">\r\n\t\t\t\t{makePageHeader(this.user, adding ? 'stored-add' : 'stored')}\r\n\t\t\t\t{(() => {\r\n\t\t\t\t\tif (!adding) {\r\n\t\t\t\t\t\tconst buf = [];\r\n\t\t\t\t\t\tfor (let giveaway of giveaways) {\r\n\t\t\t\t\t\t\tif (wifiData.storedGiveaways.lottery.includes(giveaway as LotteryGiveawayData)) {\r\n\t\t\t\t\t\t\t\tgiveaway = giveaway as LotteryGiveawayData;\r\n\t\t\t\t\t\t\t\tconst targetUser = Users.get(giveaway.targetUserID);\r\n\t\t\t\t\t\t\t\tbuf.push(<div class=\"infobox\">\r\n\t\t\t\t\t\t\t\t\t<h3 style={{textAlign: 'center'}}>Lottery</h3>\r\n\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t<strong>Game:</strong> {gameName[giveaway.game]}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Giver:</strong> {giveaway.targetUserID}, {}\r\n\t\t\t\t\t\t\t\t\t<strong>OT:</strong> {giveaway.ot}, <strong>TID:</strong> {giveaway.tid}<br />\r\n\t\t\t\t\t\t\t\t\t<strong># of winners:</strong> {giveaway.winners}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Pok&eacute; Ball:</strong> <psicon item={giveaway.ball} />\r\n\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t<summary><psicon pokemon={giveaway.prize.species} /> Prize</summary>\r\n\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{Giveaway.convertIVs(giveaway.prize, giveaway.ivs)}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t{!!giveaway.extraInfo?.trim() && <>\r\n\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t<summary>Extra Info</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{giveaway.extraInfo.trim()}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t<button class=\"button\" name=\"send\" value={\r\n\t\t\t\t\t\t\t\t\t\t`/giveaway delete lottery,${wifiData.storedGiveaways.lottery.indexOf(giveaway) + 1}`\r\n\t\t\t\t\t\t\t\t\t}><i class=\"fa fa-trash\"></i> Delete giveaway</button>\r\n\t\t\t\t\t\t\t\t\t{!targetUser?.connected ?\r\n\t\t\t\t\t\t\t\t\t\t<button title=\"The giver is offline\" disabled class=\"button disabled\" style={{float: 'right'}}>\r\n\t\t\t\t\t\t\t\t\t\t\tCreate giveaway\r\n\t\t\t\t\t\t\t\t\t\t</button> :\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" style={{float: 'right'}} name=\"send\" value={\r\n\t\t\t\t\t\t\t\t\t\t\t`/giveaway create lottery ${giveaway.targetUserID}|${giveaway.ot}|${giveaway.tid}|${giveaway.game}|${giveaway.winners}|${giveaway.ivs.join('/')}|${giveaway.ball}|${giveaway.extraInfo.trim().replace(/\\n/g, '<br />')}|${Teams.pack([giveaway.prize])}`\r\n\t\t\t\t\t\t\t\t\t\t}>Create giveaway</button>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tgiveaway = giveaway as QuestionGiveawayData;\r\n\t\t\t\t\t\t\t\tconst targetUser = Users.get(giveaway.targetUserID);\r\n\t\t\t\t\t\t\t\tbuf.push(<div class=\"infobox\">\r\n\t\t\t\t\t\t\t\t\t<h3 style={{textAlign: 'center'}}>Lottery</h3>\r\n\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t<strong>Game:</strong> {gameName[giveaway.game]}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Giver:</strong> {giveaway.targetUserID}, {}\r\n\t\t\t\t\t\t\t\t\t<strong>OT:</strong> {giveaway.ot}, <strong>TID:</strong> {giveaway.tid}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Question:</strong> {giveaway.question}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Answer{Chat.plural(giveaway.answers.length, \"s\")}:</strong> {giveaway.answers.join(', ')}<br />\r\n\t\t\t\t\t\t\t\t\t<strong>Pok&eacute; Ball:</strong> <psicon item={giveaway.ball} />\r\n\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t<summary><psicon pokemon={giveaway.prize.species} /> Prize</summary>\r\n\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{Giveaway.convertIVs(giveaway.prize, giveaway.ivs)}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t{!!giveaway.extraInfo?.trim() && <>\r\n\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t<summary>Extra Info</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{giveaway.extraInfo.trim()}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t<button class=\"button\" name=\"send\" value={\r\n\t\t\t\t\t\t\t\t\t\t`/giveaway delete question,${wifiData.storedGiveaways.question.indexOf(giveaway) + 1}`\r\n\t\t\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-trash\"></i> Delete giveaway\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t{!targetUser?.connected ?\r\n\t\t\t\t\t\t\t\t\t\t<button title=\"The giver is offline\" disabled class=\"button disabled\" style={{float: 'right'}}>\r\n\t\t\t\t\t\t\t\t\t\t\tCreate giveaway\r\n\t\t\t\t\t\t\t\t\t\t</button> :\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" style={{float: 'right'}} name=\"send\" value={\r\n\t\t\t\t\t\t\t\t\t\t\t`/giveaway create question ${giveaway.targetUserID}|${giveaway.ot}|${giveaway.tid}|${giveaway.game}|${giveaway.question}|${giveaway.answers.join(',')}|${giveaway.ivs.join('/')}|${giveaway.ball}|${giveaway.extraInfo.trim().replace(/\\n/g, '<br />')}|${Teams.pack([giveaway.prize])}`\r\n\t\t\t\t\t\t\t\t\t\t}>Create giveaway</button>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</div>);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn <><h2>Stored Giveaways</h2>{buf}</>;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn <><h2>Store a Giveaway</h2>\r\n\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\tif (!type || !['question', 'lottery'].includes(type)) {\r\n\t\t\t\t\t\t\t\t\treturn <center>\r\n\t\t\t\t\t\t\t\t\t\t<h3>Pick a giveaway type</h3>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-stored-add-lottery`, <><i class=\"fa fa-random\"></i> Lottery</>)\r\n\t\t\t\t\t\t\t\t\t\t} | {\r\n\t\t\t\t\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-stored-add-question`, <><i class=\"fa fa-question\"></i> Question</>)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</center>;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tswitch (type) {\r\n\t\t\t\t\t\t\t\tcase 'lottery':\r\n\t\t\t\t\t\t\t\t\treturn <form data-submitsend=\"/giveaway store lottery {giver}|{ot}|{tid}|{game}|{winners}|{ivs}|{ball}|{info}|{set}\">\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"giver\">Giver: </label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ot\">OT: </label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"tid\">TID: </label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\"value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"winners\">Number of winners: </label><input name=\"winners\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"set\">Prize:</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable\" name=\"set\"></textarea><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"info\">Additional information (if any):</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Store Lottery Giveaway</button>\r\n\t\t\t\t\t\t\t\t\t</form>;\r\n\t\t\t\t\t\t\t\tcase 'question':\r\n\t\t\t\t\t\t\t\t\treturn <form data-submitsend={\r\n\t\t\t\t\t\t\t\t\t\t\"/giveaway store question {giver}|{ot}|{tid}|{game}|{question}|{answers}|{ivs}|{ball}|{info}|{set}\"\r\n\t\t\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"giver\">Giver:</label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ot\">OT:</label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"tid\">TID:</label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\"value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"question\">Question:</label><input name=\"question\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"answers\">Answers (separated by comma):</label><input name=\"answers\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"set\"></label>\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable here\" name=\"set\"></textarea>\r\n\t\t\t\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"info\">Additional information (if any):</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Store Question Giveaway</button>\r\n\t\t\t\t\t\t\t\t\t</form>;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t})()}\r\n\t\t\t</div>;\r\n\t\t},\r\n\t\tsubmitted(args, user) {\r\n\t\t\tthis.title = `[Submitted Giveaways]`;\r\n\t\t\tif (!Rooms.search('wifi')) return <h1>There is no Wi-Fi room on this server.</h1>;\r\n\t\t\tconst [add, type] = args;\r\n\t\t\tconst adding = add === 'add';\r\n\t\t\tif (!adding) this.checkCan('warn', null, Rooms.get('wifi')!);\r\n\t\t\tconst giveaways = [\r\n\t\t\t\t...((wifiData.submittedGiveaways || {}).lottery || []),\r\n\t\t\t\t...((wifiData.submittedGiveaways || {}).question || []),\r\n\t\t\t];\r\n\t\t\tif (!giveaways.length && !adding) {\r\n\t\t\t\treturn <div class=\"pad\">\r\n\t\t\t\t\t{makePageHeader(this.user, args[0] === 'add' ? 'submitted-add' : 'submitted')}\r\n\t\t\t\t\t<h2>There are no submitted giveaways.</h2>\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t\treturn <div class=\"pad\">\r\n\t\t\t\t{makePageHeader(this.user, args[0] === 'add' ? 'submitted-add' : 'submitted')}\r\n\t\t\t\t{(() => {\r\n\t\t\t\t\tif (!adding) {\r\n\t\t\t\t\t\tconst buf = [];\r\n\t\t\t\t\t\tfor (let giveaway of giveaways) {\r\n\t\t\t\t\t\t\tconst claimCmd = giveaway.claimed === user.id ?\r\n\t\t\t\t\t\t\t\t`/giveaway unclaim ${giveaway.targetUserID}` :\r\n\t\t\t\t\t\t\t\t`/giveaway claim ${giveaway.targetUserID}`;\r\n\t\t\t\t\t\t\tconst claimedTitle = giveaway.claimed === user.id ?\r\n\t\t\t\t\t\t\t\t\"Unclaim\" : giveaway.claimed ?\r\n\t\t\t\t\t\t\t\t\t`Claimed by ${giveaway.claimed}` : `Claim`;\r\n\t\t\t\t\t\t\tconst disabled = giveaway.claimed && giveaway.claimed !== user.id ? \" disabled\" : \"\";\r\n\t\t\t\t\t\t\tbuf.push(<div class=\"infobox\">\r\n\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\tif (wifiData.submittedGiveaways.lottery.includes(giveaway as LotteryGiveawayData)) {\r\n\t\t\t\t\t\t\t\t\t\tgiveaway = giveaway as LotteryGiveawayData;\r\n\t\t\t\t\t\t\t\t\t\treturn <>\r\n\t\t\t\t\t\t\t\t\t\t\t<h3 style={{textAlign: 'center'}}>Lottery</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Game:</strong> {gameName[giveaway.game]}, <strong>Giver:</strong> {giveaway.targetUserID}, {}\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>OT:</strong> {giveaway.ot}, <strong>TID:</strong> {giveaway.tid}, {}\r\n\t\t\t\t\t\t\t\t\t\t\t<strong># of winners:</strong> {giveaway.winners}\r\n\t\t\t\t\t\t\t\t\t\t\t{!!giveaway.claimed && <><br /><strong>Claimed:</strong> {giveaway.claimed}</>}<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Pok&eacute; Ball:</strong> <psicon item={giveaway.ball} />\r\n\t\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<summary><psicon pokemon={giveaway.prize.species} /> Prize</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{Giveaway.convertIVs(giveaway.prize, giveaway.ivs)}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t\t\t{!!giveaway.extraInfo?.trim() && <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<summary>Extra Info</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{giveaway.extraInfo.trim()}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t\t</>;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tgiveaway = giveaway as QuestionGiveawayData;\r\n\t\t\t\t\t\t\t\t\t\treturn <>\r\n\t\t\t\t\t\t\t\t\t\t\t<h3 style={{textAlign: 'center'}}>Question</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Game:</strong> {gameName[giveaway.game]}, <strong>Giver:</strong> {giveaway.targetUserID}, {}\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>OT:</strong> {giveaway.ot}, <strong>TID:</strong> {giveaway.tid}\r\n\t\t\t\t\t\t\t\t\t\t\t{!!giveaway.claimed && <><br /><strong>Claimed:</strong> {giveaway.claimed}</>}<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Question:</strong> {giveaway.question}<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Answer{Chat.plural(giveaway.answers.length, \"s\")}:</strong> {giveaway.answers.join(', ')}<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Pok&eacute; Ball:</strong> <psicon item={giveaway.ball} />\r\n\t\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<summary><psicon pokemon={giveaway.prize.species} /> Prize</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{Giveaway.convertIVs(giveaway.prize, giveaway.ivs)}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t\t\t{!!giveaway.extraInfo?.trim() && <>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<details>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<summary>Extra Info</summary>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Chat.JSX.FormatText isTrusted>{giveaway.extraInfo.trim()}</Chat.JSX.FormatText>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</details>\r\n\t\t\t\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t\t\t\t</>;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t<hr />\r\n\t\t\t\t\t\t\t\t{!Users.get(giveaway.targetUserID)?.connected ? <>\r\n\t\t\t\t\t\t\t\t\t<button title=\"The giver is offline\" class=\"button disabled\" disabled>\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-times-circle\"></i> Deny giveaway\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button style={{textAlign: 'center'}} class={`button${disabled}`} name=\"send\" value={`/msgroom wifi,${claimCmd}`}>\r\n\t\t\t\t\t\t\t\t\t\t{claimedTitle}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button title=\"The giver is offline\" disabled class=\"button disabled\" style={{float: 'right'}}>\r\n\t\t\t\t\t\t\t\t\t\tCreate giveaway\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</> : <>\r\n\t\t\t\t\t\t\t\t\t<button class=\"button\" name=\"send\" value={`/giveaway deny ${giveaway.targetUserID}`}>\r\n\t\t\t\t\t\t\t\t\t\t<i class=\"fa fa-times-circle\"></i> Deny giveaway\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button style={{textAlign: 'center'}} class={`button${disabled}`} name=\"send\" value={`/msgroom wifi,${claimCmd}`}>\r\n\t\t\t\t\t\t\t\t\t\t{claimedTitle}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button class=\"button\" style={{float: 'right'}} name=\"send\" value={`/giveaway approve ${giveaway.targetUserID}`}>\r\n\t\t\t\t\t\t\t\t\t\tCreate giveaway\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</>}\r\n\t\t\t\t\t\t\t</div>);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn <><h2>Submitted Giveaways</h2>{buf}</>;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn <>\r\n\t\t\t\t\t\t\t<h2>Submit a Giveaway</h2>\r\n\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\tif (!type || !['question', 'lottery'].includes(type)) {\r\n\t\t\t\t\t\t\t\t\treturn <center>\r\n\t\t\t\t\t\t\t\t\t\t<h3>Pick a giveaway type</h3>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-submitted-add-lottery`, <><i class=\"fa fa-random\"></i> Lottery</>)\r\n\t\t\t\t\t\t\t\t\t\t} | {\r\n\t\t\t\t\t\t\t\t\t\t\tformatFakeButton(`/view-giveaways-submitted-add-question`, <><i class=\"fa fa-question\"></i> Question</>)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t</center>;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tswitch (type) {\r\n\t\t\t\t\t\t\t\tcase 'lottery':\r\n\t\t\t\t\t\t\t\t\treturn <form data-submitsend=\"/giveaway submit lottery {giver}|{ot}|{tid}|{game}|{winners}|{ivs}|{ball}|{info}|{set}\">\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"giver\">Giver: </label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ot\">OT: </label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"tid\">TID: </label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\"value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"winners\">Number of winners: </label><input name=\"winners\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"set\">Prize:</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable\" name=\"set\"></textarea><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"info\">Additional information (provide a link of proof here):</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Submit Lottery Giveaway</button>\r\n\t\t\t\t\t\t\t\t\t</form>;\r\n\t\t\t\t\t\t\t\tcase 'question':\r\n\t\t\t\t\t\t\t\t\treturn <form data-submitsend={\r\n\t\t\t\t\t\t\t\t\t\t\"/giveaway submit question {giver}|{ot}|{tid}|{game}|{question}|{answers}|{ivs}|{ball}|{info}|{set}\"\r\n\t\t\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"giver\">Giver:</label><input name=\"giver\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ot\">OT:</label><input name=\"ot\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"tid\">TID:</label><input name=\"tid\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\tGame: <div>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"bdsp\" name=\"game\" value=\"bdsp\" /><label for=\"bdsp\">BDSP</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"swsh\" name=\"game\"value=\"swsh\" /><label for=\"swsh\">SwSh</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"sv\" name=\"game\" value=\"sv\" checked /><label for=\"sv\">SV</label>\r\n\t\t\t\t\t\t\t\t\t\t</div><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"question\">Question:</label><input name=\"question\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"answers\">Answers (separated by comma):</label><input name=\"answers\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t{generatePokeballDropdown()}<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"ivs\">IVs (Formatted like \"1/30/31/X/HT/30\"): </label><input name=\"ivs\" /><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"set\"></label>\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '70%', height: '300px'}} placeholder=\"Paste set importable\" name=\"set\"></textarea><br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<label for=\"info\">Additional information (provide a link of proof here):</label><br />\r\n\t\t\t\t\t\t\t\t\t\t<textarea style={{width: '50%', height: '100px'}} placeholder=\"Add any additional info\" name=\"info\"></textarea>\r\n\t\t\t\t\t\t\t\t\t\t<br /><br />\r\n\t\t\t\t\t\t\t\t\t\t<button class=\"button\" type=\"submit\">Submit Question Giveaway</button>\r\n\t\t\t\t\t\t\t\t\t</form>;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t})()}\r\n\t\t\t</div>;\r\n\t\t},\r\n\t},\r\n};\r\n\r\nChat.multiLinePattern.register(`/giveaway (create|new|start|store|submit|save) (question|lottery) `);\r\n"],
  "mappings": "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",
  "names": []
}
